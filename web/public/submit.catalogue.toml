# SPDX-License-Identifier: AGPL-3.0-only
# Copyright (C) 2025-2026 Antony Cartwright
#
# The Quiet Feed - Bundle Catalog
# Defines access tiers and activities

version = "2.0.0"

# ============================================================================
# ACCESS TIERS (Bundles)
# ============================================================================

# ANONYMOUS - Default tier for unauthenticated users
[[bundles]]
id = "anonymous"
name = "Anonymous"
allocation = "automatic"
description = "Curated public feed with SCORE visible"

# ENHANCE - Granted on authentication
[[bundles]]
id = "enhance"
name = "Enhance"
allocation = "on-auth"
description = "Personal feeds, all features enabled"
cap = 1000
features = ["score", "trace", "dedup", "mute", "wire-mode", "shield"]

# HARD COPY - Paid subscription tier
[[bundles]]
id = "hard-copy"
name = "Hard Copy"
allocation = "subscription"
description = "Unlimited platforms, export, API access"
cap = 100
timeout = "P1M"
listedInEnvironments = ["local", "test", "proxy", "proxyRunning", "ci", "prod"]
subscriptionTier = "hard-copy"
features = ["score", "trace", "dedup", "mute", "wire-mode", "shield", "demote", "cluster", "export", "api"]

# ============================================================================
# ACTIVITIES
# ============================================================================

[[activities]]
id = "view-feed"
name = "View curated feed"
bundles = ["anonymous", "enhance", "hard-copy"]
paths = ["index.html", "^/$"]

[[activities]]
id = "view-about"
name = "View about page"
bundles = ["anonymous", "enhance", "hard-copy"]
paths = ["index.html?feed=about"]

[[activities]]
id = "view-settings"
name = "View settings"
bundles = ["anonymous", "enhance", "hard-copy"]
paths = ["index.html?feed=settings"]

[[activities]]
id = "manage-bundles"
name = "Manage subscriptions"
bundles = ["enhance", "hard-copy"]
paths = ["account/bundles.html", "^/api/v1/bundle.*"]

[[activities]]
id = "api-feed"
name = "API access to feeds"
bundles = ["hard-copy"]
paths = ["^/api/v1/feed.*"]

[[activities]]
id = "api-score"
name = "API access to scoring"
bundles = ["hard-copy"]
paths = ["^/api/v1/score.*"]

# ============================================================================
# FEATURES
# ============================================================================

[[features]]
id = "score"
name = "SCORE"
description = "Quality rating 0-100 for each feed item"
tier = "anonymous"

[[features]]
id = "trace"
name = "TRACE"
description = "Origin tracking and propagation path"
tier = "enhance"

[[features]]
id = "dedup"
name = "DEDUP"
description = "Semantic deduplication of similar content"
tier = "enhance"

[[features]]
id = "mute"
name = "MUTE"
description = "Complete exclusion of topics or sources"
tier = "anonymous"

[[features]]
id = "wire-mode"
name = "WIRE MODE"
description = "Headline normalization - rewrites sensational headlines"
tier = "enhance"

[[features]]
id = "shield"
name = "SHIELD"
description = "Dark pattern neutralization - no autoplay, no infinite scroll"
tier = "anonymous"

[[features]]
id = "demote"
name = "DEMOTE"
description = "Promotional rebalancing - marks and downranks sponsored content"
tier = "hard-copy"

[[features]]
id = "cluster"
name = "CLUSTER"
description = "Topic and geographic segmentation"
tier = "hard-copy"

[[features]]
id = "export"
name = "Export"
description = "Export your feed data"
tier = "hard-copy"

[[features]]
id = "api"
name = "API Access"
description = "Programmatic access to feeds and scoring"
tier = "hard-copy"
