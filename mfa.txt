
> web-submit-diyaccounting-co-uk@0.0.2-4 test:submitVatBehaviour-proxy-report
> HMRC_ACCOUNT=sandbox npm run test:submitVatBehaviour-proxy ; npm run test-report -- --testName submitVatBehaviour --testFile ./behaviour-tests/submitVat.behaviour.test.js --envFile .env.proxy && ./scripts/publish-web-test-local.sh target/behaviour-test-results/test-report-submitVatBehaviour.json web-test-local


> web-submit-diyaccounting-co-uk@0.0.2-4 test:submitVatBehaviour-proxy
> npx dotenv -e .env.proxy -- npm run test:submitVatBehaviour


> web-submit-diyaccounting-co-uk@0.0.2-4 test:submitVatBehaviour
> playwright test --project=submitVatBehaviour

dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:51.203Z","msg":"Reading CDK configuration from /Users/antony/projects/submit.diyaccounting.co.uk/cdk-application/cdk.json"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:51.203Z","msg":"CDK context:"}
dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"envFilePath: .env.proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"envName: proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"serverPort: 3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"runTestServer: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"runProxy: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"runMockOAuth2: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"testAuthProvider: mock"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"testAuthUsername: user"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"baseUrl: https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"hmrcTestUsername: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"hmrcTestPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"hmrcTestVatNumber: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.210Z","msg":"runDynamoDb: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.211Z","msg":"bundleTableName: test-bundle-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.211Z","msg":"hmrcApiRequestsTableName: test-hmrc-api-requests-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:51.211Z","msg":"receiptsTableName: test-receipts-table"}

Running 1 test using 1 worker

dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.173Z","msg":"Reading CDK configuration from /Users/antony/projects/submit.diyaccounting.co.uk/cdk-application/cdk.json"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.174Z","msg":"CDK context:"}
dotenvConfigIfNotBlank: Loading environment config from .env
dotenvConfigIfNotBlank: Loading environment config from .env
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"envFilePath: .env.proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"envName: proxy"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"serverPort: 3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"runTestServer: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"runProxy: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"runMockOAuth2: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"testAuthProvider: mock"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"testAuthUsername: user"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"baseUrl: https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"hmrcTestUsername: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"hmrcTestPassword: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"hmrcTestVatNumber: null"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"runDynamoDb: run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"bundleTableName: test-bundle-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"hmrcApiRequestsTableName: test-hmrc-api-requests-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.181Z","msg":"receiptsTableName: test-receipts-table"}
Starting beforeAll hook...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.870Z","msg":"[dynamodb]: runDynamoDb=run, bundleTableName=test-bundle-table, hmrcApiRequestsTableName=test-hmrc-api-requests-table, receiptsTableName=test-receipts-table"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.870Z","msg":"[dynamodb]: DYNAMODB_PORT not set; using ephemeral port (0)"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.870Z","msg":"[dynamodb]: Starting dynalite (local DynamoDB) server..."}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.878Z","msg":"[dynamodb]: Started at http://127.0.0.1:52137"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.878Z","msg":"[dynamodb]: Ensuring bundle table: 'test-bundle-table' exists on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.907Z","msg":"[dynamodb]: ℹ️ Table 'test-bundle-table' not found on endpoint 'http://127.0.0.1:52137', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.914Z","msg":"[dynamodb]: ✅ Created table 'test-bundle-table' on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.914Z","msg":"[dynamodb]: Ensuring HMRC API requests table: 'test-hmrc-api-requests-table' exists on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.921Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-api-requests-table' not found on endpoint 'http://127.0.0.1:52137', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.924Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-api-requests-table' on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.924Z","msg":"[dynamodb]: Ensuring receipts table: 'test-receipts-table' exists on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.929Z","msg":"[dynamodb]: ℹ️ Table 'test-receipts-table' not found on endpoint 'http://127.0.0.1:52137', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.931Z","msg":"[dynamodb]: ✅ Created table 'test-receipts-table' on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.931Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-return-post-async-requests-table' exists on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.936Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-return-post-async-requests-table' not found on endpoint 'http://127.0.0.1:52137', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.938Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-return-post-async-requests-table' on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.938Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-return-get-async-requests-table' exists on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.943Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-return-get-async-requests-table' not found on endpoint 'http://127.0.0.1:52137', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.947Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-return-get-async-requests-table' on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.947Z","msg":"[dynamodb]: Ensuring async requests table: 'test-hmrc-vat-obligation-get-async-requests-table' exists on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.951Z","msg":"[dynamodb]: ℹ️ Table 'test-hmrc-vat-obligation-get-async-requests-table' not found on endpoint 'http://127.0.0.1:52137', creating..."}
{"level":30,"source":"app/bin/dynamodb.js","time":"2026-01-08T00:13:52.953Z","msg":"[dynamodb]: ✅ Created table 'test-hmrc-vat-obligation-get-async-requests-table' on endpoint 'http://127.0.0.1:52137'"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.953Z","msg":"[auth]: runMockOAuth2=run"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.953Z","msg":"[auth]: Starting mock-oauth2-server process..."}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:52.956Z","msg":"[auth]: Checking server readiness for... http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:52.973Z","msg":"[auth]: Server is ready! at http://localhost:8080/default/debugger"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.973Z","msg":"[http]: runTestServer=run, httpServerPort=3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:52.973Z","msg":"[http]: Starting server process..."}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:52.977Z","msg":"[http]: Checking server readiness for... http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:52.980Z","msg":"[http]: Starting server at http://127.0.0.1:3000 after error TypeError: fetch failed"}
{"level":50,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:52.983Z","msg":"[http]: Server check attempt 1/15 failed: fetch failed from http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.199Z","msg":"[http-stdout]: > web-submit-diyaccounting-co-uk@0.0.2-4 server\n> npx dotenv -e .env.proxy -- node app/bin/server.js"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.909Z","msg":"[http-stdout]: dotenvConfigIfNotBlank: Loading environment config from .env"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.916Z","msg":"[http-stdout]: dotenvConfigIfNotBlank: Loading environment config from .env"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.922Z","msg":"[http-stdout]: Listening at http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.923Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:53.923Z\",\"msg\":\"Listening at http://127.0.0.1:3000\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.990Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:53.990Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:53.998Z","msg":"[http]: Response body"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:53.998Z","msg":"[http]: Server is ready! at http://127.0.0.1:3000"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.998Z","msg":"[proxy]: runLocalSslProxy called (delegating to runLocalNgrokProxy)"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.998Z","msg":"[proxy]: runProxy=run, httpServerPort=3000, baseUrl=https://wanted-finally-anteater.ngrok-free.app/"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:53.998Z","msg":"[proxy]: Starting ngrok tunnel using @ngrok/ngrok..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-08T00:13:53.998Z","msg":"[ngrok]: Starting ngrok tunnel for address: 3000, domain: wanted-finally-anteater.ngrok-free.app, pooling: true"}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-08T00:13:54.352Z","msg":"[ngrok]: ✅ Tunnel established at https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:54.352Z","msg":"[proxy]: Started at https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:54.352Z","msg":"[proxy]: Checking server readiness for... https://wanted-finally-anteater.ngrok-free.app"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:54.493Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:54.492Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/serverHelper.js","time":"2026-01-08T00:13:54.518Z","msg":"[proxy]: Server is ready! at https://wanted-finally-anteater.ngrok-free.app"}
beforeAll hook completed successfully
[HMRC Test User] Sandbox mode detected without full credentials - creating test user
[HMRC Test User] Creating HMRC sandbox test user with VAT enrolment using client credentials
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.103Z","message":"[HMRC Test User Creation] Starting test user creation","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","serviceNames":["mtd-vat"],"hmrcClientId":"uqMHA6Rs..."}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.104Z","message":"[HMRC Test User Creation] Request details (pre-token)","method":"POST","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","body":{"serviceNames":["mtd-vat"]}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.104Z","message":"[HMRC Test User Creation] Requesting OAuth2 access token","tokenUrl":"https://test-api.service.hmrc.gov.uk/oauth/token","grantType":"client_credentials"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.269Z","message":"[HMRC Test User Creation] Token response received","status":200,"statusText":"OK","hasAccessToken":true}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.270Z","message":"[HMRC Test User Creation] Request details (create-test-user)","method":"POST","url":"https://test-api.service.hmrc.gov.uk/create-test-user/organisations","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"Bearer ***REDACTED***"},"body":{"serviceNames":["mtd-vat"]}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.719Z","message":"[HMRC Test User Creation] Response received","status":201,"statusText":"Created","responseBody":{"userId":"869172854733","password":"QmvSrkR6kqTw","userFullName":"Oakley Weller","emailAddress":"oakley.weller@example.com","organisationDetails":{"name":"Company HPRG9D","address":{"line1":"37 Kentish Town Road","line2":"Nottingham","postcode":"TS14 1PA"}},"individualDetails":{"firstName":"Oakley","lastName":"Weller","dateOfBirth":"1953-12-06","address":{"line1":"20 Tower Hill","line2":"Twickenham","postcode":"TS2 1PA"}},"vatRegistrationDate":"2025-01-08","groupIdentifier":"238858693969","vrn":"948796348"}}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.719Z","message":"[HMRC Test User Creation] Test user created successfully","userId":"869172854733","userFullName":"Oakley Weller","organisationName":"Company HPRG9D"}
[HMRC Test User] Successfully created test user:
  User ID: 869172854733
  User Full Name: Oakley Weller
  VAT Registration Number: 948796348
  Organisation: Company HPRG9D
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.719Z","message":"[HMRC Test User] Saving test user details to JSON files","outputDir":"/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour","repoRoot":"/Users/antony/projects/submit.diyaccounting.co.uk"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.720Z","message":"[HMRC Test User] Saved test user to artifact directory","path":"/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-test-user.json"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:55.720Z","message":"[HMRC Test User] Saved test user to repository root","path":"/Users/antony/projects/submit.diyaccounting.co.uk/hmrc-test-user.json"}
[HMRC Test User] Updated environment variables with generated credentials
Loading document...
[NAVIGATION] (1/4) Going to: https://wanted-finally-anteater.ngrok-free.app/ - Loading home page
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.106Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.106Z\",\"msg\":\"HTTP GET /\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.177Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.177Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.179Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.179Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.180Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.180Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.181Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.181Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.198Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.198Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.200Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.200Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.201Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.201Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.202Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.202Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.204Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.203Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: User is not authenticated
[BROWSER CONSOLE log]: User is not authenticated
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.281Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.281Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.285Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.285Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.288Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.391Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.391Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Checking home page...
✅ [Compliance] Privacy link visible on home page
✅ [Compliance] Terms link visible on home page
[USER INTERACTION] Clicking: a:has-text('Log in') - Clicking login link
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:56.938Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:56.937Z\",\"msg\":\"HTTP GET /auth/login.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.005Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.005Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.005Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.005Z\",\"msg\":\"HTTP GET /images/g-logo.png\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.007Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.007Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.028Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.028Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.029Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.030Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.030Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.031Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.030Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.031Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.031Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.031Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.031Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.033Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.032Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.034Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.033Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.034Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.034Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.035Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.035Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.123Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.123Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.127Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.127Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.131Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.131Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.185Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.185Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Logging in...
[USER INTERACTION] Clicking: button:has-text('Continue with mock-oauth2-server') - Continue with OAuth provider
[BROWSER CONSOLE log]: Initiating navikt/mock-oauth2-server login
[BROWSER CONSOLE log]: Clear stored tokens and user info
[BROWSER CONSOLE log]: Getting auth URL. Remote call initiated: GET /api/v1/mock/authUrl?state=79p5vyi79t
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.854Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:57.854Z\",\"msg\":\"HTTP GET /api/v1/mock/authUrl?state=79p5vyi79t\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:13:57.856Z\",\"requestId\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/mock/authUrl?state=79p5vyi79t&state=79p5vyi79t\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"cognito:username\":\"test\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/mock/authUrl\"}},\"path\":\"/api/v1/mock/authUrl\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/auth/login.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-client-request-id\":\"5eef66ca-92b3-4965-bbd6-51e8329a5d67\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\"},\"queryStringParameters\":{\"state\":\"79p5vyi79t\"},\"rawQueryString\":\"state=79p5vyi79t\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/non-lambda-mocks/mockAuthUrlGet.js\",\"time\":\"2026-01-08T00:13:57.856Z\",\"requestId\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"message\":\"Generating mock authorization URL\",\"state\":\"79p5vyi79t\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:57.856Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:13:57.856Z\",\"requestId\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/mock/authUrl?state=79p5vyi79t&state=79p5vyi79t\",\"response\":{\"statusCode\":200,\"headers\":{\"x-request-id\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"08ebd0c8-3e90-42c9-aa7f-a20b0041b7ad\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"authUrl\\\":\\\"http://localhost:8080/oauth/authorize?response_type=code&client_id=debugger&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Fauth%2FloginWithMockCallback.html&scope=openid%20somescope&state=79p5vyi79t&identity_provider=MockOAuth2Server\\\"}\"}}"}
[BROWSER CONSOLE log]: Got auth URL. Remote call completed successfully: GET /api/v1/mock/authUrl?state=79p5vyi79t {authUrl: http://localhost:8080/oauth/authorize?response_typ…ate=79p5vyi79t&identity_provider=MockOAuth2Server}
[BROWSER CONSOLE log]: Status message: Handing off to http://localhost:8080/oauth/authorize?response_type=code&client_id=debugger&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Fauth%2FloginWithMockCallback.html&scope=openid%20somescope&state=79p5vyi79t&identity_provider=MockOAuth2Server Type: info
[BROWSER CONSOLE log]: Redirecting to navikt/mock-oauth2-server
[USER INTERACTION] Filling: input[name="username"] with value: "user" - Entering username
[USER INTERACTION] Filling: textarea[name="claims"] with value: "{"email":"user@example.com"}" - Entering identity claims
[USER INTERACTION] Clicking: input[type="submit"][value="Sign-in"] - Submitting sign-in form
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.738Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.738Z\",\"msg\":\"HTTP GET /auth/loginWithMockCallback.html?code=MFNQTwNLymU16rDEDmpR8j-K9QWXTr1zzGy7DsjXAT4&state=79p5vyi79t\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.803Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.803Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.817Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.817Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.827Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.827Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.841Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.841Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.841Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.841Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.842Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.842Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.842Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.842Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.842Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.842Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.844Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.844Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
[BROWSER CONSOLE log]: Authentication callback received with code: MFNQTwNLymU16rDEDmpR8j-K9QWXTr1zzGy7DsjXAT4
[BROWSER CONSOLE log]: Status message: Exchanging authorization code for access token... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.933Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.933Z\",\"msg\":\"HTTP POST /api/v1/mock/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:13:59.964Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:13:59.964Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[BROWSER CONSOLE log]: Received tokens from mock {"token_type":"Bearer","id_token":"eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ","access_token":"eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw","refresh_token":"4717e5c6-b8ee-4547-bc78-73450b4c2717","expires_in":3599}
[BROWSER CONSOLE log]: Received id_token from mock {"sub":"user","aud":"debugger","nbf":1767831239,"azp":"debugger","iss":"http://localhost:8080/default","exp":1767834839,"iat":1767831239,"jti":"812fd7c7-447e-4830-8a26-f879ffccb108","tid":"default","email":"user@example.com"}
[BROWSER CONSOLE log]: User authenticated successfully using mock: user@example.com
[BROWSER CONSOLE log]: No MFA detected in mock amr claims: []
[BROWSER CONSOLE log]: Status message: Authenticated successfully. Fetching bundles... Type: info
[BROWSER CONSOLE log]: Status message: Authenticated successfully. Redirecting... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.040Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.040Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.098Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.098Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.109Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.109Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.112Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.112Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.113Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.113Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.114Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.114Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.115Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.115Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.116Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.116Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.117Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.117Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.182Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.182Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:00.182Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/subHasher.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"message\":\"Using USER_SUB_HASH_SALT from environment (local dev/test)\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.183Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.184Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.262Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.262Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.263Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.263Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.263Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:00.263Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d0269d90-7082-493f-b376-a52d59e49334\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.264Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.264Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.308Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.308Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.308Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.308Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.309Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:00.308Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:00.308Z\",\"requestId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"cef821ad-aa31-49cb-b343-824e3c1c37cb\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.310Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.309Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.310Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:00.309Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:00.309Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:00.309Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:00.310Z\",\"requestId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"d0269d90-7082-493f-b376-a52d59e49334\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.332Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.332Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:00.361Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:00.361Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
Checking home page...
CloudWatch RUM analytics consent dialog is visible, accepting...
[USER INTERACTION] Clicking: button:has-text("Accept") - Accept CloudWatch RUM consent
Opening hamburger menu...
[USER INTERACTION] Clicking: button.hamburger-btn - Opening hamburger menu
[USER INTERACTION] Clicking: a[href*='bundles.html'] - Clicking Bundles in hamburger menu
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.519Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.519Z\",\"msg\":\"HTTP GET /account/bundles.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.592Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.592Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.592Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.592Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.594Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.594Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.617Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.617Z\",\"msg\":\"HTTP GET /lib/bundle-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.617Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.617Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.618Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.618Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.619Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.619Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.619Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.619Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.620Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.620Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.620Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.620Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.621Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.621Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.622Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.622Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.704Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.704Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.704Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.704Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.704Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:02.704Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.705Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:02.704Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"54e6d8af-399e-429f-b345-75832ac404e5\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.705Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.705Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:02.705Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.705Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.705Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.705Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.705Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.705Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.705Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.709Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.709Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.709Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.709Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.709Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:02.709Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.709Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:02.709Z\",\"requestId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"54e6d8af-399e-429f-b345-75832ac404e5\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.711Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.711Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.712Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.713Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.713Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.715Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.715Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.716Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:02.716Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:02.716Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:02.716Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.716Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:02.716Z\",\"requestId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"2ca9931e-5ea6-4ced-a505-853cfd20d326\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.806Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.806Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.807Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.807Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:02.863Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:02.863Z\",\"msg\":\"HTTP GET /submit.environment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:03.363Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
Ensuring Test bundle is present...
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (1/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (2/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (3/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (4/5)
[polling to ensure present]: Test bundle still not present.
[polling to ensure present]: "Added ✓ Test" button not visible, waiting 1000ms and trying again (5/5)
[polling to ensure present]: Test bundle still not present.
Test bundle not present, requesting...
Requesting Test bundle...
[polling be ready to request]: Test bundle request button already visible.
[USER INTERACTION] Clicking: button:has-text('Request Test') - Request Test
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.655Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:09.655Z\",\"msg\":\"HTTP POST /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.656Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:09.656Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.656Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:09.656Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"35\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/account/bundles.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"bundleId\\\":\\\"test\\\",\\\"qualifiers\\\":{}}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.656Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.656Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Processing bundle request\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:09.656Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.656Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.656Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Processing bundle request for user\",\"userId\":\"user\",\"bundleId\":\"test\",\"waitTimeMs\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.657Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:09.656Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Executing synchronous processing\",\"userId\":\"user\",\"waitTimeMs\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.657Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.657Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"grantBundle entry\",\"userId\":\"user\",\"requestedBundle\":\"test\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.657Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.657Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.657Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.662Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.662Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.662Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.665Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Loaded catalog bundle:\",\"bundleId\":\"test\",\"catalogBundle\":{\"id\":\"test\",\"name\":\"Test\",\"allocation\":\"on-request\",\"cap\":10,\"timeout\":\"P1D\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.665Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"[Catalog bundle] Bundle requires manual allocation, proceeding:\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.665Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"[Catalog bundle] Bundle cap not yet reached:\",\"requestedBundle\":\"test\",\"currentCount\":0,\"cap\":10}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.665Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Granting bundle to user:\",\"userId\":\"user\",\"requestedBundle\":\"test\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.665Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"New bundle details:\",\"newBundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.665Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.665Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Updated user bundles:\",\"userId\":\"user\",\"currentBundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.666Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.666Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Updating bundles for user user with 1\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.666Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.666Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.666Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.669Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.669Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":0}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.669Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":0}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.669Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Current bundles for user user in DynamoDB count: 0\",\"currentBundles\":[]}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.669Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Current bundle IDs for user user in DynamoDB count: undefined\",\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.669Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"New bundle IDs for user user count: undefined\",\"newBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.670Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Bundles to remove for user user in DynamoDB\",\"bundlesToRemove\":[]}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.670Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Checking if bundle test needs adding for user user in DynamoDB\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.670Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Adding new bundle test for user user in DynamoDB\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.670Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"putBundle [table: test-bundle-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.670Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Storing bundle\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"userId\":\"user\",\"bundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.670Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.670Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Storing bundle in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"item\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.675Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:09.675Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Bundle stored in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"item\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:09.675Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Updated bundles for user user in DynamoDB\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:09.675Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundlePost.js\",\"time\":\"2026-01-08T00:14:09.675Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Bundle granted to user:\",\"userId\":\"user\",\"newBundle\":{\"bundleId\":\"test\",\"expiry\":\"2026-01-09\"}}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:09.675Z\",\"requestId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"9f0895b5-28f0-4cae-83e8-6c46f37ffbcb\",\"message\":\"Returning result with status 201\"}"}
[BROWSER CONSOLE log]: Status message: Bundle "Test" added successfully. Type: success
[polling to ensure request completed]: Test bundle already present.
[USER INTERACTION] Clicking: button:has-text('Back to Home') - Back to Home
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.321Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.321Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.384Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.384Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.408Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.408Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.432Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.432Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.433Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.433Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.433Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.433Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.434Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.434Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.435Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.435Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.435Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.435Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.436Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.436Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.517Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.517Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.517Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:10.517Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.517Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:10.517Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.517Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:10.518Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.518Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.518Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.518Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.518Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.518Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.522Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.522Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.522Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.522Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.522Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:10.522Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.522Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:10.522Z\",\"requestId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"d7af385f-888f-4324-bf1a-0ee3a270ebd1\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.526Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.526Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.528Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.528Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.529Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:10.528Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.529Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.529Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.529Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.529Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.529Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.533Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.532Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.534Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.534Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.534Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:10.534Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:10.534Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:10.534Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.534Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:10.534Z\",\"requestId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"d5ad6ed7-0085-41c7-ba16-8140361258be\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.609Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.608Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:10.618Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:10.618Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:11.173Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: button:has-text('Submit VAT (HMRC Sandbox)') - Starting VAT return submission
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:11.943Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:11.943Z\",\"msg\":\"HTTP GET /hmrc/vat/submitVat.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.000Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.000Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.024Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.024Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.024Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.024Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.037Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.036Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.046Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.046Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.047Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.047Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.047Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.047Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.048Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.048Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.048Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.048Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.049Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.049Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.050Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (no action taken)
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.132Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.132Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.139Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"cab3ee74-1766-478e-933f-df6e3f818251\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.140Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.143Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.142Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.143Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.143Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.146Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.145Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.146Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.146Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:12.146Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.146Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:12.146Z\",\"requestId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"cab3ee74-1766-478e-933f-df6e3f818251\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.146Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:12.146Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.148Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:12.148Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:12.148Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:12.148Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:12.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:12.148Z\",\"requestId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"c9e7ccfb-c39c-43df-a69b-b8189811adbe\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:13.353Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated VAT submission form with test data
[USER INTERACTION] Filling: #vatNumber with value: "948796348" - Entering VAT number
[USER INTERACTION] Filling: #periodKey with value: "25R9" - Entering period key
[USER INTERACTION] Filling: #vatDue with value: "1000.00" - Entering VAT due amount
[USER INTERACTION] Focusing: #submitBtn - the Submit button
[USER INTERACTION] Clicking: #submitBtn - Submitting VAT form
[BROWSER CONSOLE log]: Status message: Initiating HMRC authentication... Type: info
[BROWSER CONSOLE log]: Stored pending request and current activity: {"vatNumber":"948796348","periodKey":"25R9","vatDue":"1000.00","testScenario":"","runFraudPreventionHeaderValidation":false} /hmrc/vat/submitVat.html sandbox
[BROWSER CONSOLE log]: Using client-side generated HMRC Auth URL: https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=98b982cdb6d74ac791733f84886d7f95
[BROWSER CONSOLE log]: Current activity set to: /hmrc/vat/submitVat.html
[BROWSER CONSOLE log]: Status message: Redirecting to HMRC for authentication at https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=98b982cdb6d74ac791733f84886d7f95... Type: info
[BROWSER CONSOLE log]: Page transition initiated: Redirecting to HMRC OAuth URL https://test-api.service.hmrc.gov.uk/oauth/authorize?response_type=code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&scope=write%3Avat%20read%3Avat&state=98b982cdb6d74ac791733f84886d7f95
[USER INTERACTION] Clicking: Continue button - Continuing with HMRC permission
[USER INTERACTION] Clicking: [Locator] - Continue
[USER INTERACTION] Clicking: Sign in to HMRC button - Starting HMRC authentication
[USER INTERACTION] Clicking: [Locator] - Sign in to the HMRC online service
[BROWSER ERROR]: Cannot read properties of null (reading 'addEventListener')
[BROWSER ERROR]: Cannot read properties of undefined (reading 'initAll')
[USER INTERACTION] Filling: #userId with value: "869172854733" - Entering HMRC user ID
[USER INTERACTION] Filling: #password with value: "QmvSrkR6kqTw" - Entering HMRC password
[USER INTERACTION] Clicking: Sign in button - Submitting HMRC credentials
[USER INTERACTION] Clicking: [Locator] - Sign in
[USER INTERACTION] Clicking: #givePermission - Give permission
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.479Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.479Z\",\"msg\":\"HTTP GET /activities/submitVatCallback.html?code=15d929e02a51491ea9ac310457815a3c&state=98b982cdb6d74ac791733f84886d7f95\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.549Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.549Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.563Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.563Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.564Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.564Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.564Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.564Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.572Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.572Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.584Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.584Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.585Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.585Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.585Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.585Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.585Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.585Z\",\"msg\":\"HTTP GET /widgets/loading-spinner.js\"}"}
[BROWSER CONSOLE log]: OAuth callback handler
[BROWSER CONSOLE log]: Page transition initiated: Clearing URL parameters
[BROWSER CONSOLE log]: OAuth callback handler (normal completion)
[BROWSER CONSOLE log]: Status message: Exchanging authorization code for access token... Type: info
[BROWSER CONSOLE log]: Exchanging token. Remote call initiated: POST /api/v1/hmrc/token ++ Body: {"code":"15d929e02a51491ea9ac310457815a3c"}
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.709Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.709Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.710Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.710Z\",\"msg\":\"HTTP POST /api/v1/hmrc/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.711Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:24.710Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.711Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.711Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/token?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/token\"}},\"path\":\"/api/v1/hmrc/token\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"43\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"code\\\":\\\"15d929e02a51491ea9ac310457815a3c\\\"}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.711Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-08T00:14:24.711Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"Exchanging authorization code for HMRC access token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-08T00:14:24.711Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"msg\":\"Retrieving HMRC client secret from arn \"}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcTokenPost.js\",\"time\":\"2026-01-08T00:14:24.711Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"msg\":\"Secret retrieved from override and cached\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.712Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/oauth/token\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"headers\":{\"Content-Type\":\"application/x-www-form-urlencoded\",\"x-request-id\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\"},\"body\":\"grant_type=authorization_code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&client_secret=049b662f-61ea-4113-b38d-a9c8b1bb9f13&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&code=15d929e02a51491ea9ac310457815a3c\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.712Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"Performing HTTP POST for token exchange\",\"providerUrl\":\"https://test-api.service.hmrc.gov.uk/oauth/token\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.756Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.756Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.756Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.756Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.756Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.756Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.761Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.759Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/activities/submitVatCallback.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.760Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.763Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.763Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.763Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.763Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.763Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.763Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:24.763Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.763Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.763Z\",\"requestId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"d8c13dbc-eed1-475e-b072-a5c8bd9c482a\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.766Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.766Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.766Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:24.766Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:24.766Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:24.766Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.766Z\",\"requestId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"32e1ed56-70f6-4439-97eb-bce252cf4c7b\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.896Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.896Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"HTTP POST response received with status and duration\",\"status\":200,\"duration\":184}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.897Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:24.897Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:24.906Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/oauth/token\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.906Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"exchangeClientSecretForAccessToken response\",\"responseStatus\":200,\"responseTokens\":{\"access_token\":\"3272583c6767455c5f4751d6f48b1076\",\"refresh_token\":\"4f1ff589d447319988116b71633c9ba1\",\"expires_in\":14400,\"scope\":\"write:vat read:vat\",\"token_type\":\"bearer\"},\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"tokenType\":\"bearer\",\"scope\":\"write:vat read:vat\",\"expiresIn\":14400,\"hasRefreshToken\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.906Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"Token exchange succeeded\",\"accessTokenLength\":32,\"hasIdToken\":false,\"hasRefreshToken\":true,\"expiresIn\":14400,\"tokenType\":\"bearer\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.906Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:24.906Z\",\"requestId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/token?\",\"response\":{\"statusCode\":200,\"headers\":{\"x-request-id\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"b91379b0-ea3b-4e49-828d-d13638a411ce\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"accessToken\\\":\\\"3272583c6767455c5f4751d6f48b1076\\\",\\\"hmrcAccessToken\\\":\\\"3272583c6767455c5f4751d6f48b1076\\\",\\\"refreshToken\\\":\\\"4f1ff589d447319988116b71633c9ba1\\\",\\\"expiresIn\\\":14400,\\\"tokenType\\\":\\\"bearer\\\"}\"}}"}
[BROWSER CONSOLE log]: Exchanged token. Remote call completed successfully: POST /api/v1/hmrc/token {accessToken: 3272583c6767455c5f4751d6f48b1076, hmrcAccessToken: 3272583c6767455c5f4751d6f48b1076, refreshToken: 4f1ff589d447319988116b71633c9ba1, expiresIn: 14400, tokenType: bearer} 3272583c6767455c5f4751d6f48b1076
[BROWSER CONSOLE log]: Status message: Obtained Access Token from HMRC... Type: info
[BROWSER CONSOLE log]: Current activity found: /hmrc/vat/submitVat.html
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:24.964Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:24.964Z\",\"msg\":\"HTTP GET /hmrc/vat/submitVat.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.046Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.046Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.047Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.047Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.050Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.051Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.052Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.051Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.067Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.067Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.068Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.068Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.069Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.069Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.070Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.070Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.072Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.072Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.073Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.073Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (code present, auto-continue)
[BROWSER CONSOLE log]: Retrieved submission data: {vatNumber: 948796348, periodKey: 25R9, vatDue: 1000.00, testScenario: , runFraudPreventionHeaderValidation: false}
[BROWSER CONSOLE log]: Status message: Submitting VAT return to HMRC... Type: info
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.136Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.136Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.143Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.143Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.143Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:25.143Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.144Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.144Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.144Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.144Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.144Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.147Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.148Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.148Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.148Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.148Z\",\"requestId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"a79cfbbb-ea92-41be-b7bf-8695fcd99202\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
[BROWSER CONSOLE log]: Submitting VAT. Remote call initiated: POST /api/v1/hmrc/vat/return ++ Body: {"vatNumber":"948796348","periodKey":"25R9","vatDue":"1000.00","accessToken":"3272583c6767455c5f4751d6f48b1076","runFraudPreventionHeaderValidation":false}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.155Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:25.155Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.155Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.156Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Retrieving user bundles\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:25.156Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.156Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.156Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.156Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.156Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.156Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.157Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.157Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.158Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.158Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:25.158Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.158Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.158Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.158Z\",\"requestId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"d5f092f8-ab5f-4420-a2e6-b771cc0d0896\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.177Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:25.177Z\",\"msg\":\"HTTP POST /api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.177Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:25.177Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.178Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.178Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"155\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:25.149Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"5339ecb6-d319-48d2-a935-f6ce86a7a752\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"948796348\\\",\\\"periodKey\\\":\\\"25R9\\\",\\\"vatDue\\\":\\\"1000.00\\\",\\\"accessToken\\\":\\\"3272583c6767455c5f4751d6f48b1076\\\",\\\"runFraudPreventionHeaderValidation\\\":false}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.178Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.178Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.178Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.178Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.178Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.178Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.178Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.178Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"155\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:25.149Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"5339ecb6-d319-48d2-a935-f6ce86a7a752\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"948796348\\\",\\\"periodKey\\\":\\\"25R9\\\",\\\"vatDue\\\":\\\"1000.00\\\",\\\"accessToken\\\":\\\"3272583c6767455c5f4751d6f48b1076\\\",\\\"runFraudPreventionHeaderValidation\\\":false}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.181Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.181Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.181Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.181Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.181Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.183Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:25.183Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.183Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.183Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.183Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:25.183Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:25.184Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"3272583c...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:25.184Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Checking for test scenario\":null}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:25.184Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:25.184Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.184Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.184Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.185Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.185Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.185Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.185Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.186Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:25.185Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Skipping fraud prevention header validation for HMRC API request\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":false}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.186Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:25.186Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:25.149Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"body\":{\"periodKey\":\"25R9\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":0,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0,\"finalised\":true},\"environment\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.186Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:25.186Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Request to POST https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"method\":\"POST\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:25.149Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"body\":\"{\\\"periodKey\\\":\\\"25R9\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":0,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0,\\\"finalised\\\":true}\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.187Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.187Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.187Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.202Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.202Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.202Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.202Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.203Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.202Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.203Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:25.203Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:25.149Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Retry-After\":\"5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [POST /api/v1/hmrc/vat/return] (timeout: 1630000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... (poll #1) Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.371Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:25.371Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Response from POST https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"status\":201,\"hmrcResponseBody\":{\"processingDate\":\"2026-01-08T00:14:25.361Z\",\"formBundleNumber\":\"182326150164\",\"paymentIndicator\":\"DD\",\"chargeRefNumber\":\"GFpuOum4aEfNo26B\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.371Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.371Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.375Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.374Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns\",\"method\":\"POST\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.375Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:25.375Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Received HMRC response: {}\",\"httpResult\":{\"hmrcResponse\":{},\"hmrcResponseBody\":{\"processingDate\":\"2026-01-08T00:14:25.361Z\",\"formBundleNumber\":\"182326150164\",\"paymentIndicator\":\"DD\",\"chargeRefNumber\":\"GFpuOum4aEfNo26B\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.375Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:25.375Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"DynamoDB enabled, proceeding with putReceipt [table: test-receipts-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.375Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:25.375Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Storing receipt\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"userSub\":\"user\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.376Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:25.376Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Storing receipt in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\",\"ttl_datestamp\":\"2033-01-06T00:14:25.376Z\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.382Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:25.382Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Receipt stored in DynamoDB as item\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.382Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.382Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Local async processing completed successfully\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.382Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:25.382Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-return-post-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.382Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:25.386Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:25.386Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [POST /api/v1/hmrc/vat/return] (poll #1, elapsed: 1004ms, timeout: 1630000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"msg\":\"HTTP POST /api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"155\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:25.149Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"5339ecb6-d319-48d2-a935-f6ce86a7a752\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"948796348\\\",\\\"periodKey\\\":\\\"25R9\\\",\\\"vatDue\\\":\\\"1000.00\\\",\\\"accessToken\\\":\\\"3272583c6767455c5f4751d6f48b1076\\\",\\\"runFraudPreventionHeaderValidation\\\":false}\"}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:26.265Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"POST\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return\"}},\"path\":\"/api/v1/hmrc/vat/return\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"content-length\":\"155\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:25.149Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"origin\":\"https://wanted-finally-anteater.ngrok-free.app\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"5339ecb6-d319-48d2-a935-f6ce86a7a752\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{},\"body\":\"{\\\"vatNumber\\\":\\\"948796348\\\",\\\"periodKey\\\":\\\"25R9\\\",\\\"vatDue\\\":\\\"1000.00\\\",\\\"accessToken\\\":\\\"3272583c6767455c5f4751d6f48b1076\\\",\\\"runFraudPreventionHeaderValidation\\\":false}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.267Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:26.267Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:26.267Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"3272583c...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Checking for test scenario\":null}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:26.269Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-post-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.272Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:26.272Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-post-async-requests-table\"}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:26.272Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.272Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnPost.js\",\"time\":\"2026-01-08T00:14:26.272Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Found persisted request\",\"status\":\"completed\"}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:26.272Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:26.272Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:26.272Z\",\"requestId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return?\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1d1a265a-ef23-478f-93c5-f49d808b9787\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:25.149Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"665b3d53-ac7e-4311-8bca-864bf233ea09\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"receipt\\\":{\\\"processingDate\\\":\\\"2026-01-08T00:14:25.361Z\\\",\\\"formBundleNumber\\\":\\\"182326150164\\\",\\\"paymentIndicator\\\":\\\"DD\\\",\\\"chargeRefNumber\\\":\\\"GFpuOum4aEfNo26B\\\"},\\\"hmrcResponse\\\":{\\\"ok\\\":true,\\\"status\\\":201,\\\"statusText\\\":\\\"Created\\\",\\\"headers\\\":{\\\"cache-control\\\":\\\"no-cache,no-store,max-age=0\\\",\\\"connection\\\":\\\"keep-alive\\\",\\\"content-length\\\":\\\"140\\\",\\\"content-security-policy\\\":\\\"default-src 'self'\\\",\\\"content-type\\\":\\\"application/json\\\",\\\"date\\\":\\\"Thu, 08 Jan 2026 00:14:25 GMT\\\",\\\"receipt-id\\\":\\\"4ad4c7d4-23f2-4159-b12a-c1e2e4c3606c\\\",\\\"receipt-signature\\\":\\\"This has been deprecated - DO NOT USE\\\",\\\"receipt-timestamp\\\":\\\"2026-01-08T00:14:25Z\\\",\\\"strict-transport-security\\\":\\\"max-age=31536000;\\\",\\\"vary\\\":\\\"Origin\\\",\\\"via\\\":\\\"1.1 4e8b36cb6949156d16691b29df3318d6.cloudfront.net (CloudFront)\\\",\\\"x-amz-cf-id\\\":\\\"uiGowaIbKW7_sK2BKoELpHJ5_HksadY4byvqCQxaj5yjTSEJkI8Obw==\\\",\\\"x-amz-cf-pop\\\":\\\"LHR50-P6\\\",\\\"x-cache\\\":\\\"Miss from cloudfront\\\",\\\"x-content-type-options\\\":\\\"nosniff, nosniff\\\",\\\"x-correlationid\\\":\\\"4ad4c7d4-23f2-4159-b12a-c1e2e4c3606c\\\",\\\"x-envoy-upstream-service-time\\\":\\\"33\\\",\\\"x-frame-options\\\":\\\"SAMEORIGIN\\\"}},\\\"hmrcResponseBody\\\":{\\\"processingDate\\\":\\\"2026-01-08T00:14:25.361Z\\\",\\\"formBundleNumber\\\":\\\"182326150164\\\",\\\"paymentIndicator\\\":\\\"DD\\\",\\\"chargeRefNumber\\\":\\\"GFpuOum4aEfNo26B\\\"},\\\"receiptId\\\":\\\"2026-01-08T00:14:25.375Z-182326150164\\\"}\"}}"}
[BROWSER CONSOLE log]: finished async request [POST /api/v1/hmrc/vat/return] (poll #1, elapsed: 1070ms, status: 200)
[BROWSER CONSOLE log]: Submitted VAT. Remote call completed successfully: POST /api/v1/hmrc/vat/return {receipt: Object, hmrcResponse: Object, hmrcResponseBody: Object, receiptId: 2026-01-08T00:14:25.375Z-182326150164} {processingDate: 2026-01-08T00:14:25.361Z, formBundleNumber: 182326150164, paymentIndicator: DD, chargeRefNumber: GFpuOum4aEfNo26B}
[BROWSER CONSOLE log]: Status message: VAT return processed Type: success
[BROWSER CONSOLE log]: Page display transition: Displaying receipt and hiding form
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: Continue submission handler (success)
Waiting for VAT submission to complete and receipt to be displayed...
Current URL: https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/submitVat.html?hmrcAccount=sandbox
Page title: DIY Accounting Submit
Body element exists: true
Main content element exists: true
Receipt element exists: true
Receipt element style: display: block;
Form element exists: true
Form element style: display: none;
Receipt element visible: true
VAT submission flow completed successfully
Opening hamburger menu to go to receipts...
[USER INTERACTION] Clicking: button.hamburger-btn - Opening hamburger menu for receipts
[USER INTERACTION] Clicking: a:has-text('Receipts') - Clicking Receipts in hamburger menu
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:29.949Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:29.949Z\",\"msg\":\"HTTP GET /hmrc/receipt/receipts.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.008Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.008Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.009Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.008Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.029Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.029Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.049Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.049Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.049Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.049Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.050Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.051Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.051Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.052Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.052Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.114Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.114Z\",\"msg\":\"HTTP GET /api/v1/hmrc/receipt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:30.115Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.115Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt\"}},\"path\":\"/api/v1/hmrc/receipt\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"6015ed92-0391-473d-b287-2610cc3bdd26\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.115Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.115Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Extracting user information from event\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.115Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.115Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.115Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt\"}},\"path\":\"/api/v1/hmrc/receipt\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"6015ed92-0391-473d-b287-2610cc3bdd26\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.116Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.116Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.116Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.116Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.116Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.116Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.119Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.119Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt\",\"requiredBundleIds\":[\"default\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.119Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.119Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcReceiptGet.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Listing user receipts\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.120Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"DynamoDB enabled, proceeding with listUserReceipts [table: test-receipts-table]\",\"userSub\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:30.119Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Retrieving receipts from DynamoDB\",\"userSub\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:30.121Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Queried DynamoDB for user receipts\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:30.122Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Retrieved receipts from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.122Z\",\"requestId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"6015ed92-0391-473d-b287-2610cc3bdd26\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"receipts\\\":[{\\\"receiptId\\\":\\\"2026-01-08T00:14:25.375Z-182326150164\\\",\\\"key\\\":\\\"receipts/user/2026-01-08T00:14:25.375Z-182326150164.json\\\",\\\"name\\\":\\\"2026-01-08T00:14:25.375Z-182326150164.json\\\",\\\"timestamp\\\":\\\"2026-01-08T00:14:25.375Z\\\",\\\"formBundleNumber\\\":\\\"182326150164\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:25.376Z\\\",\\\"lastModified\\\":\\\"2026-01-08T00:14:25.376Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.122Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.122Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"013dabef-b8d4-496d-8ced-943976ab23ba\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.126Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.126Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.128Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.127Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}\n{\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.127Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.128Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.128Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.128Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.128Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.128Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.128Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.130Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.129Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.130Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.130Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:30.130Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.130Z\",\"requestId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"013dabef-b8d4-496d-8ced-943976ab23ba\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.131Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.131Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.131Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:30.131Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:30.131Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:30.131Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.131Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:30.131Z\",\"requestId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"2a8507e4-ce5c-4656-88b1-9f83d94879f2\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:30.221Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:30.221Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
Checking receipts page...
Found receipts, clicking on first receipt...
[USER INTERACTION] Clicking: [Locator] - Open first receipt
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.752Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:31.752Z\",\"msg\":\"HTTP GET /api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.753Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:31.753Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.753Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:31.753Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\"}},\"path\":\"/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{\"name\":\"2026-01-08T00:14:25.375Z-182326150164.json\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.753Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.753Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.753Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.753Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.753Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.754Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:31.753Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\"}},\"path\":\"/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/receipt/receipts.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{\"name\":\"2026-01-08T00:14:25.375Z-182326150164.json\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.754Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.754Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:31.754Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.754Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:31.754Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.757Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.757Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\",\"requiredBundleIds\":[\"default\"],\"currentBundleIds\":{}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/receipt/2026-01-08T00%3A14%3A25.375Z-182326150164.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.757Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcReceiptGet.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Retrieving single receipt\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\",\"key\":\"receipts/user/2026-01-08T00:14:25.375Z-182326150164.json\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.757Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"DynamoDB enabled, proceeding with getReceipt [table: test-receipts-table]\",\"userSub\":\"user\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.757Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:31.757Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Retrieving receipt from DynamoDB\",\"userSub\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:31.759Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbReceiptRepository.js\",\"time\":\"2026-01-08T00:14:31.759Z\",\"requestId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"4cec1c40-80c8-4dbf-bc25-0a2eaac16412\",\"message\":\"Retrieved receipt from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"receiptId\":\"2026-01-08T00:14:25.375Z-182326150164\"}"}
Returning to home via hamburger menu...
[USER INTERACTION] Clicking: button.hamburger-btn - Opening hamburger menu to go home
[USER INTERACTION] Clicking: a:has-text('Home') - Clicking Home in hamburger menu
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:32.916Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:32.916Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:32.975Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:32.974Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:32.991Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:32.991Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.000Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.000Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.013Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.013Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.013Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.013Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.014Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.013Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.019Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.019Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.021Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.021Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.022Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.021Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.079Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.079Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:33.079Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.080Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:33.079Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"6a846452-4310-49ec-b0b5-a5d392755153\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.080Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.079Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:33.080Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.080Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.080Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.080Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.080Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.080Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.082Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.082Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.082Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:33.082Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.082Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:33.082Z\",\"requestId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"6a846452-4310-49ec-b0b5-a5d392755153\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.083Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"59589d3f-8452-4358-b19a-f0087f0abd95\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.084Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.084Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.086Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.086Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.086Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.086Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.087Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.087Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:33.087Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:33.087Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:33.087Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:33.087Z\",\"requestId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"59589d3f-8452-4358-b19a-f0087f0abd95\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.169Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.191Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.191Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.191Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
[USER INTERACTION] Clicking: button:has-text('View VAT Return (HMRC Sandbox)') - Starting View VAT Return
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:33.942Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:33.942Z\",\"msg\":\"HTTP GET /hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.006Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.001Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.021Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.021Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.026Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.026Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.043Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.043Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.043Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.043Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.044Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.044Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.050Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.050Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.050Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.051Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.052Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.052Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.053Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.053Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (accessToken found)
[BROWSER CONSOLE log]: No pending return request found
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.131Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.131Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.133Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.133Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.134Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.134Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.134Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.134Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.134Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.134Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.136Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.136Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.136Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.136Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.136Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:34.136Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:34.136Z\",\"requestId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"71f6c7ed-b989-48f1-93c3-4a68510030ec\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.139Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.139Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.139Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:34.139Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:34.139Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"70e798cf-ff65-4385-9002-997cf5960a6f\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.140Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.142Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.142Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.142Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:34.142Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:34.142Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:34.142Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:34.142Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:34.142Z\",\"requestId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"70e798cf-ff65-4385-9002-997cf5960a6f\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:35.338Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated view VAT return form with test data
[USER INTERACTION] Filling: #vrn with value: "948796348" - Entering VAT registration number
[USER INTERACTION] Filling: #periodKey with value: "25R9" - Entering period key
[USER INTERACTION] Clicking: button:has-text('Show Developer Options') - Show Developer Options
Checked runFraudPreventionHeaderValidation checkbox
[USER INTERACTION] Focusing: #retrieveBtn - Retrieve button
[USER INTERACTION] Clicking: #retrieveBtn - Submitting view VAT return form
[BROWSER CONSOLE log]: Status message: Retrieving VAT return... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.284Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:38.284Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.284Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:38.284Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.285Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:38.285Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true&vrn=948796348&runFraudPreventionHeaderValidation=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return/25R9\"}},\"path\":\"/api/v1/hmrc/vat/return/25R9\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:38.203Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"fbc3b2cb-79d6-4c93-aa90-b04d04b05375\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"runFraudPreventionHeaderValidation\":\"true\"},\"rawQueryString\":\"vrn=948796348&runFraudPreventionHeaderValidation=true\",\"pathParameters\":{\"periodKey\":\"25R9\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.285Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.285Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.285Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.285Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.285Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:38.285Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true&vrn=948796348&runFraudPreventionHeaderValidation=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return/25R9\"}},\"path\":\"/api/v1/hmrc/vat/return/25R9\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:38.203Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"fbc3b2cb-79d6-4c93-aa90-b04d04b05375\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"runFraudPreventionHeaderValidation\":\"true\"},\"rawQueryString\":\"vrn=948796348&runFraudPreventionHeaderValidation=true\",\"pathParameters\":{\"periodKey\":\"25R9\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.286Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.286Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:38.286Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.286Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:38.286Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:38.288Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:38.288Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return/25R9\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return/25R9\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"3272583c...\",\"isValidFormat\":true}}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.289Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:38.289Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Validating fraud prevention headers for sandbox account\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":true}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.290Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.290Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Validating fraud prevention headers\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"headers\":[\"Gov-Client-Public-IP\",\"Gov-Client-Device-ID\",\"Gov-Client-User-IDs\",\"Gov-Client-Connection-Method\",\"Gov-Vendor-Public-IP\",\"Gov-Vendor-Forwarded\",\"Gov-Vendor-Product-Name\",\"Gov-Vendor-Version\",\"Gov-Client-Browser-JS-User-Agent\",\"Gov-Client-Public-IP-Timestamp\",\"Gov-Client-Screens\",\"Gov-Client-Timezone\",\"Gov-Client-Window-Size\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.292Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:38.292Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.292Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.296Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.296Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.297Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:38.297Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.297Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:38.297Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true&vrn=948796348&runFraudPreventionHeaderValidation=true\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:38.203Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"Retry-After\":\"5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [GET /api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true] (timeout: 730000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.460Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.460Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Fraud prevention header validation response\",\"status\":200,\"code\":\"INVALID_HEADERS\",\"validationMessage\":\"At least 1 header is invalid\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.460Z","msg":"[http-stdout]: {\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.460Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Fraud prevention header validation errors\",\"errors\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-public-port\"]}]}\n{\"level\":40,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.460Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Fraud prevention header validation warnings\",\"warnings\":[{\"code\":\"MISSING_HEADER\",\"message\":\"Header missing. This may be correct for single factor authentication, for example username and password. If this is the case, you must contact us explaining why you cannot submit this header.\",\"headers\":[\"gov-client-multi-factor\"]},{\"code\":\"MISSING_HEADER\",\"message\":\"Header required\",\"headers\":[\"gov-vendor-license-ids\"]}]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.460Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.460Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.464Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.463Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.464Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.464Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:38.203Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.577Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:38.577Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9\",\"status\":200,\"hmrcResponseBody\":{\"periodKey\":\"25R9\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":0,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.577Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.577Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.580Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.580Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.580Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:38.580Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Local async processing completed successfully\"}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:38.580Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-return-get-async-requests-table\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.580Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:38.582Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:38.582Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [GET /api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true] (poll #1, elapsed: 1001ms, timeout: 730000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:39.353Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.353Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:39.353Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.354Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:39.353Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true&vrn=948796348&runFraudPreventionHeaderValidation=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return/25R9\"}},\"path\":\"/api/v1/hmrc/vat/return/25R9\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:38.203Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"fbc3b2cb-79d6-4c93-aa90-b04d04b05375\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"runFraudPreventionHeaderValidation\":\"true\"},\"rawQueryString\":\"vrn=948796348&runFraudPreventionHeaderValidation=true\",\"pathParameters\":{\"periodKey\":\"25R9\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.354Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.354Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.354Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.354Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.354Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:39.354Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true&vrn=948796348&runFraudPreventionHeaderValidation=true\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/return/25R9\"}},\"path\":\"/api/v1/hmrc/vat/return/25R9\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:38.203Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/viewVatReturn.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"fbc3b2cb-79d6-4c93-aa90-b04d04b05375\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"runFraudPreventionHeaderValidation\":\"true\"},\"rawQueryString\":\"vrn=948796348&runFraudPreventionHeaderValidation=true\",\"pathParameters\":{\"periodKey\":\"25R9\"}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.355Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.355Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.355Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:39.355Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:39.355Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.357Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.357Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return/25R9\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.357Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/return/25R9\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.357Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"3272583c...\",\"isValidFormat\":true}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.358Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:39.357Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.358Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:39.358Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-return-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.360Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:39.360Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-return-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.360Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:39.360Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatReturnGet.js\",\"time\":\"2026-01-08T00:14:39.360Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Found persisted request\",\"status\":\"completed\"}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:39.360Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:39.360Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:39.360Z\",\"requestId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true&vrn=948796348&runFraudPreventionHeaderValidation=true\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"b76e1602-11f2-49f5-8030-296a075931a3\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:38.203Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"e974b8ad-d75c-4631-99e7-006babb12a55\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"periodKey\\\":\\\"25R9\\\",\\\"vatDueSales\\\":1000,\\\"vatDueAcquisitions\\\":0,\\\"totalVatDue\\\":1000,\\\"vatReclaimedCurrPeriod\\\":0,\\\"netVatDue\\\":1000,\\\"totalValueSalesExVAT\\\":0,\\\"totalValuePurchasesExVAT\\\":0,\\\"totalValueGoodsSuppliedExVAT\\\":0,\\\"totalAcquisitionsExVAT\\\":0}\"}}"}
[BROWSER CONSOLE log]: finished async request [GET /api/v1/hmrc/vat/return/25R9?vrn=948796348&runFraudPreventionHeaderValidation=true] (poll #1, elapsed: 1067ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT return retrieved. Type: success
[BROWSER CONSOLE log]: Hiding all status messages
View VAT return completed successfully
Returning to home via hamburger menu...
[USER INTERACTION] Clicking: button.hamburger-btn - Opening hamburger menu to go home
[USER INTERACTION] Clicking: a:has-text('Home') - Clicking Home in hamburger menu
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.508Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.508Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.571Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.567Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.587Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.587Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.591Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.591Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.609Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.609Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.609Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.609Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.610Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.610Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.610Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.610Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.611Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.611Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.611Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.611Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.673Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.673Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.676Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.676Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.676Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.676Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.676Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:40.676Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:40.676Z\",\"requestId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"17a63ef4-4830-4478-94f0-dceefd2f2d04\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.679Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.679Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"f3051803-5140-435e-9eab-ab203e87996f\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.682Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.682Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.683Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.684Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:40.684Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:40.684Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.684Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:40.684Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:40.684Z\",\"requestId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"f3051803-5140-435e-9eab-ab203e87996f\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.750Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.775Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.775Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:40.775Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:40.775Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: button:has-text('VAT Obligations (HMRC Sandbox)') - Starting VAT Obligations
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.533Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.533Z\",\"msg\":\"HTTP GET /hmrc/vat/vatObligations.html?hmrcAccount=sandbox\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.596Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.590Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.608Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.608Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.616Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.616Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.629Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.629Z\",\"msg\":\"HTTP GET /lib/test-data-generator.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.630Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.630Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.639Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.638Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.639Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.639Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.640Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.640Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.641Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.641Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.641Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.641Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.642Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.642Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
[BROWSER CONSOLE log]: JS block finished loading.
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: JS block started loading: DOMContentLoaded event handler
[BROWSER CONSOLE log]: OAuth callback handler (accessToken found)
[BROWSER CONSOLE log]: No pending obligations request found
[BROWSER CONSOLE log]: JS block finished loading: DOMContentLoaded event handler
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.712Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.712Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.717Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.717Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.718Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.718Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.720Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.720Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.720Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.720Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.720Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:41.720Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:41.720Z\",\"requestId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"f02196e3-4cec-4239-9972-c3cdaca681e8\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.721Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.721Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.722Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.722Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.722Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.722Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.722Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.722Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:41.723Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.724Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:41.724Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:41.724Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:41.724Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:41.724Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:41.724Z\",\"requestId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"0e57323e-6dd7-4c9a-b23b-9ef8d4169e45\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:43.042Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[USER INTERACTION] Clicking: #testDataLink a - Clicking add test data link
[BROWSER CONSOLE log]: [Test Data] Populated VAT obligations form with test data
[USER INTERACTION] Filling: #vrn with value: "948796348" - Entering VAT registration number
[USER INTERACTION] Filling: #fromDate with value: "2025-01-01" - Entering from date
[USER INTERACTION] Filling: #toDate with value: "2025-12-01" - Entering to date
[USER INTERACTION] Focusing: #status - the obligations status filter
[USER INTERACTION] Focusing: #retrieveBtn - Retrieve button
[USER INTERACTION] Clicking: #retrieveBtn - Submitting VAT obligations form
[BROWSER CONSOLE log]: Status message: Retrieving VAT obligations... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:46.147Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:46.148Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.148Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:46.148Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01&vrn=948796348&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:46.062Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"3848370a-2cb6-4e0f-bd9d-a36c87e78faf\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=948796348&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.149Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.148Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.148Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.148Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.149Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:46.149Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01&vrn=948796348&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:46.062Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"3848370a-2cb6-4e0f-bd9d-a36c87e78faf\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=948796348&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.149Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.149Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:46.149Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.149Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:46.149Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:46.152Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:46.152Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.152Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.152Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.152Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:46.152Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:46.152Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"3272583c...\",\"isValidFormat\":true}}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":true}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Initiating new processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Marking request as processing in DynamoDB\",\"userId\":\"user\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\",\"status\":\"processing\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Starting async processing locally (no SQS queue URL)\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Skipping fraud prevention header validation for HMRC API request\",\"hmrcAccount\":\"sandbox\",\"runFraudPreventionHeaderValidation\":false}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.153Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:46.153Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Request to GET https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\",\"headers\":{\"Content-Type\":\"application/json\",\"Accept\":\"application/vnd.hmrc.1.0+json\",\"Authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:46.062Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\"},\"testScenario\":null,\"environment\":{\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:46.155Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Checking persisted request status\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.155Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.155Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.159Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.159Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.159Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.159Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"processing\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.159Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:46.159Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Yielding with HTTP 202 Accepted\",\"location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.160Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:46.159Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01&vrn=948796348&from=2025-01-01&to=2025-12-01\",\"response\":{\"statusCode\":202,\"headers\":{\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:46.062Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"Retry-After\":\"5\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"Location\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"message\\\":\\\"Request accepted for processing\\\"}\"}}"}
[BROWSER CONSOLE log]: waiting async request [GET /api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01] (timeout: 730000ms)...
[BROWSER CONSOLE log]: Status message: Still processing... Type: info
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.299Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:46.299Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Response from GET https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01\",\"status\":200,\"hmrcResponseBody\":{\"obligations\":[{\"periodKey\":\"18A1\",\"start\":\"2017-01-01\",\"end\":\"2017-03-31\",\"due\":\"2017-05-07\",\"status\":\"F\",\"received\":\"2017-05-06\"},{\"periodKey\":\"18A2\",\"start\":\"2017-04-01\",\"end\":\"2017-06-30\",\"due\":\"2017-08-07\",\"status\":\"O\"}]}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.299Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.299Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"DynamoDB enabled, proceeding with putHmrcApiRequest [table: test-hmrc-api-requests-table]\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbHmrcApiRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.302Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"HmrcApiRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"url\":\"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01\",\"method\":\"GET\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:46.302Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Local async processing completed successfully\"}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:46.302Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Marking async request as completed\",\"userSub\":\"user\",\"asyncRequestsTableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.302Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.302Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"putAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:46.304Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:46.304Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"AsyncRequest stored in DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
[BROWSER CONSOLE log]: re-trying async request [GET /api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01] (poll #1, elapsed: 1002ms, timeout: 730000ms, last status: 202)...
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:47.265Z\",\"msg\":\"HTTP GET /api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.265Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:47.265Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:47.265Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01&vrn=948796348&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:46.062Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"3848370a-2cb6-4e0f-bd9d-a36c87e78faf\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=948796348&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.265Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"enforceBundles called\",\"hmrcBase\":\"https://test-api.service.hmrc.gov.uk\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.266Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.265Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Extracting user information from event\"}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.265Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"User info extracted from authorizer context\",\"sub\":\"user\",\"username\":\"test\",\"claims\":[\"sub\",\"username\",\"email\",\"scope\"]}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.266Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:47.266Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01&vrn=948796348&from=2025-01-01&to=2025-12-01\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"default\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"716664cc-c5ba-41e2-b02c-022882ca8d4b\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/hmrc/vat/obligation\"}},\"path\":\"/api/v1/hmrc/vat/obligation\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer 3272583c6767455c5f4751d6f48b1076\",\"cache-control\":\"no-cache\",\"content-type\":\"application/json\",\"gov-client-browser-js-user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"gov-client-device-id\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"gov-client-public-ip\":\"88.97.27.180\",\"gov-client-public-ip-timestamp\":\"2026-01-08T00:14:46.062Z\",\"gov-client-screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"gov-client-timezone\":\"UTC+00:00\",\"gov-client-user-ids\":\"browser=user\",\"gov-client-window-size\":\"width=1280&height=1446\",\"hmrcaccount\":\"sandbox\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/hmrc/vat/vatObligations.html?hmrcAccount=sandbox\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVmYXVsdCIsIm5iZiI6MTc2NzgzMTIzOSwiYXpwIjoiZGVidWdnZXIiLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvZGVmYXVsdCIsImV4cCI6MTc2NzgzNDgzOSwiaWF0IjoxNzY3ODMxMjM5LCJqdGkiOiI3MTY2NjRjYy1jNWJhLTQxZTItYjAyYy0wMjI4ODJjYThkNGIiLCJ0aWQiOiJkZWZhdWx0IiwiZW1haWwiOiJ1c2VyQGV4YW1wbGUuY29tIn0.frb2oMMnn8F3bYKFCwSrFmo8y0VK436DBdMagfPvKiFAo0gxhw4KP70FiplKfuKAJGuKJsf94ULf4F5cQgwGmoyZeIACkC1vwfSkGlnSHNacMh0Vngai1JKiAm9QznZ7bQN5aiHUhYCSaIn4Bv1Viokg7k06uwJnuhSJI0uEVtrugNDM5E40luGVt5QbUkkIYfKMszX5r8X3HfRnvlSnlLg3t7olLvxW7d7gKnEo3KRThlymId-3mZf0TOl9p9JjGG9970tX-ZosOCtQ351FWurEP_pwLKlljsrXqowfAoFK-S55aa3lJ_thF1BAsKE0dF8SZYShi6W-poPQ_bLePw\",\"x-client-request-id\":\"3848370a-2cb6-4e0f-bd9d-a36c87e78faf\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"x-wait-time-ms\":\"0\"},\"queryStringParameters\":{\"vrn\":\"948796348\",\"from\":\"2025-01-01\",\"to\":\"2025-12-01\"},\"rawQueryString\":\"vrn=948796348&from=2025-01-01&to=2025-12-01\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.267Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Fetching user bundles from storage\",\"userSub\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.267Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:47.267Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:47.267Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"User bundles retrieved\",\"userSub\":\"user\",\"bundles\":[{\"bundleId\":\"test\",\"expiry\":\"2026-01-09T00:00:00.000Z\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"createdAt\":\"2026-01-08T00:14:09.670Z\",\"ttl\":1770595200,\"ttl_datestamp\":\"2026-02-09T00:00:00.000Z\"}],\"bundleCount\":1}\n{\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Checking bundle entitlements\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\",\"requiredBundleIds\":[\"test\",\"guest\",\"business\",\"diylegacy\"],\"currentBundleIds\":{}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/bundleEnforcement.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Bundle entitlement check passed\",\"userSub\":\"user\",\"path\":\"/api/v1/hmrc/vat/obligation\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/hmrcApi.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Validating access token\",\"tokenValidation\":{\"hasAccessToken\":true,\"accessTokenLength\":32,\"accessTokenPrefix\":\"3272583c...\",\"isValidFormat\":true}}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.269Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:47.269Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"getAsyncRequest [table: test-hmrc-vat-obligation-get-async-requests-table]\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.271Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbAsyncRequestRepository.js\",\"time\":\"2026-01-08T00:14:47.271Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"AsyncRequest retrieved from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"status\":\"completed\",\"tableName\":\"test-hmrc-vat-obligation-get-async-requests-table\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.271Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:47.271Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Handler entry\",\"waitTimeMs\":0,\"isInitialRequest\":false}\n{\"level\":30,\"source\":\"app/functions/hmrc/hmrcVatObligationGet.js\",\"time\":\"2026-01-08T00:14:47.271Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Found persisted request\",\"status\":\"completed\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:47.271Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:47.271Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Returning HTTP 200 OK with result\"}\n{\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:47.271Z\",\"requestId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01&vrn=948796348&from=2025-01-01&to=2025-12-01\",\"response\":{\"statusCode\":200,\"headers\":{\"Gov-Client-Public-IP\":\"88.97.27.180\",\"Gov-Client-Device-ID\":\"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596\",\"Gov-Client-User-IDs\":\"server=anonymous\",\"Gov-Client-Connection-Method\":\"WEB_APP_VIA_SERVER\",\"Gov-Vendor-Public-IP\":\"88.97.27.180\",\"Gov-Vendor-Forwarded\":\"by=88.97.27.180&for=88.97.27.180\",\"Gov-Vendor-Product-Name\":\"web-submit-diyaccounting-co-uk\",\"Gov-Vendor-Version\":\"web-submit-diyaccounting-co-uk=0.0.2-4\",\"Gov-Client-Browser-JS-User-Agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"Gov-Client-Public-IP-Timestamp\":\"2026-01-08T00:14:46.062Z\",\"Gov-Client-Screens\":\"width=1280&height=1446&colour-depth=24&scaling-factor=1\",\"Gov-Client-Timezone\":\"UTC+00:00\",\"Gov-Client-Window-Size\":\"width=1280&height=1446\",\"x-request-id\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"f0cb8d51-c9f2-433d-8366-e84834ebd00e\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"obligations\\\":[{\\\"periodKey\\\":\\\"18A1\\\",\\\"start\\\":\\\"2017-01-01\\\",\\\"end\\\":\\\"2017-03-31\\\",\\\"due\\\":\\\"2017-05-07\\\",\\\"status\\\":\\\"F\\\",\\\"received\\\":\\\"2017-05-06\\\"},{\\\"periodKey\\\":\\\"18A2\\\",\\\"start\\\":\\\"2017-04-01\\\",\\\"end\\\":\\\"2017-06-30\\\",\\\"due\\\":\\\"2017-08-07\\\",\\\"status\\\":\\\"O\\\"}]}\"}}"}
[BROWSER CONSOLE log]: finished async request [GET /api/v1/hmrc/vat/obligation?vrn=948796348&from=2025-01-01&to=2025-12-01] (poll #1, elapsed: 1112ms, status: 200)
[BROWSER CONSOLE log]: Status message: VAT obligations retrieved. Type: success
[BROWSER CONSOLE log]: Hiding all status messages
No test scenario 1 fulfilled obligations and 1 open obligations
VAT obligations retrieval completed successfully
Returning to home via hamburger menu...
[USER INTERACTION] Clicking: button.hamburger-btn - Opening hamburger menu to go home
[USER INTERACTION] Clicking: a:has-text('Home') - Clicking Home in hamburger menu
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.884Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.884Z\",\"msg\":\"HTTP GET /index.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.947Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.945Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.965Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.965Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.969Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.969Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.988Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.988Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.988Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.988Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.989Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.989Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.990Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.990Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.990Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.990Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:48.991Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:48.991Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
[BROWSER CONSOLE log]: User is authenticated
[BROWSER CONSOLE log]: User info: {sub: user, email: user@example.com}
[BROWSER CONSOLE log]: User label: user@example.com
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Retrieving bundles for request\"}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.051Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.051Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.054Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.054Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.054Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.054Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.054Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:49.054Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.054Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:49.054Z\",\"requestId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"1f2e3816-0ca9-4c2e-b454-7a546056018a\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.057Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.057Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.059Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"msg\":\"HTTP GET /api/v1/bundle\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.059Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.059Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Processing request with event\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"event\":{\"requestContext\":{\"authorizer\":{\"lambda\":{\"jwt\":{\"claims\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"test@test.submit.diyaccunting.co.uk\",\"cognito:username\":\"test\",\"scope\":\"read write\"}}}},\"http\":{\"method\":\"GET\",\"protocol\":\"http\",\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"path\":\"/api/v1/bundle\"}},\"path\":\"/api/v1/bundle\",\"headers\":{\"host\":\"wanted-finally-anteater.ngrok-free.app\",\"user-agent\":\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36\",\"accept\":\"*/*\",\"accept-encoding\":\"gzip, deflate, br, zstd\",\"accept-language\":\"en-US\",\"authorization\":\"Bearer eyJraWQiOiJkZWZhdWx0IiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJzdWIiOiJ1c2VyIiwiYXVkIjoiZGVidWdnZXIiLCJuYmYiOjE3Njc4MzEyMzksImF6cCI6ImRlYnVnZ2VyIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2RlZmF1bHQiLCJleHAiOjE3Njc4MzQ4MzksImlhdCI6MTc2NzgzMTIzOSwianRpIjoiODEyZmQ3YzctNDQ3ZS00ODMwLThhMjYtZjg3OWZmY2NiMTA4IiwidGlkIjoiZGVmYXVsdCIsImVtYWlsIjoidXNlckBleGFtcGxlLmNvbSJ9.mLmWDD_q9qse-HlJn4c69u7gFB703E2tgYa3IURg3j3nnLkWlwxbuKkur-each9bCPPBmf5Arg3rL139zsk99SKgsfCOiNwBrrV4TwbUauMF-Bh3kbtMYSlEn28JTqroI-zliyl4npDqLK5Ri4_6H1TL_LqtO3_Qj2LX6ZKA6TlyZh7m9JZc6F4Wgnp-qSSBtPrV_G_iLIMyHtdgCLoGgo7rxyqVeiaVnMvUSEr9ELBPJ-f3UoAZz2vNVswA5X8nicYQAQu6u4P8ygp4SxyQY7eSYyH9A7Mo_tcrtH8oFfxghG-1byUy7qv0Fu1fH0H6ZUlXDNuVyqg5R1RvOF_CGQ\",\"cache-control\":\"no-cache\",\"ngrok-skip-browser-warning\":\"any value\",\"pragma\":\"no-cache\",\"priority\":\"u=1, i\",\"referer\":\"https://wanted-finally-anteater.ngrok-free.app/index.html\",\"sec-ch-ua\":\"\\\"HeadlessChrome\\\";v=\\\"143\\\", \\\"Chromium\\\";v=\\\"143\\\", \\\"Not A(Brand\\\";v=\\\"24\\\"\",\"sec-ch-ua-mobile\":\"?0\",\"sec-ch-ua-platform\":\"\\\"macOS\\\"\",\"sec-fetch-dest\":\"empty\",\"sec-fetch-mode\":\"cors\",\"sec-fetch-site\":\"same-origin\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-forwarded-for\":\"88.97.27.180\",\"x-forwarded-host\":\"wanted-finally-anteater.ngrok-free.app\",\"x-forwarded-proto\":\"https\",\"x-initial-request\":\"true\",\"x-request-id\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\"},\"queryStringParameters\":{},\"rawQueryString\":\"\",\"pathParameters\":{}}}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.059Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Retrieving user bundles\"}\n{\"level\":30,\"source\":\"app/lib/jwtHelper.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Decoded JWT payload\",\"payload\":{\"sub\":\"user\",\"aud\":\"debugger\",\"nbf\":1767831239,\"azp\":\"debugger\",\"iss\":\"http://localhost:8080/default\",\"exp\":1767834839,\"iat\":1767831239,\"jti\":\"812fd7c7-447e-4830-8a26-f879ffccb108\",\"tid\":\"default\",\"email\":\"user@example.com\"}}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Retrieving bundles for request\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.059Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"retrieveUserBundles entry\",\"userId\":\"user\"}\n{\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"getUserBundles [table: test-bundle-table]\",\"userId\":\"user\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.060Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.059Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Retrieving bundles from DynamoDB\",\"userId\":\"user\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.061Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.060Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.062Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.062Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Queried DynamoDB for user bundles\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"itemCount\":1}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.062Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/data/dynamoDbBundleRepository.js\",\"time\":\"2026-01-08T00:14:49.062Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Retrieved bundles from DynamoDB\",\"hashedSub\":\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\",\"count\":1}\n{\"level\":30,\"source\":\"app/functions/account/bundleGet.js\",\"time\":\"2026-01-08T00:14:49.062Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Successfully retrieved bundles from repository\",\"userId\":\"user\",\"count\":1}\n{\"level\":30,\"source\":\"app/services/asyncApiServices.js\",\"time\":\"2026-01-08T00:14:49.062Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Returning HTTP 200 OK with result\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.062Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/lib/httpResponseHelper.js\",\"time\":\"2026-01-08T00:14:49.062Z\",\"requestId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"correlationId\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"message\":\"Responding to request with response\",\"request\":\"https://wanted-finally-anteater.ngrok-free.app/api/v1/bundle?\",\"response\":{\"statusCode\":200,\"headers\":{\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"x-request-id\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"traceparent\":\"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01\",\"x-correlationid\":\"98720d52-b0dd-4d6f-8e75-ec76e8c3ea06\",\"Access-Control-Expose-Headers\":\"x-request-id,x-correlationid,Location,Retry-After\"},\"body\":\"{\\\"bundles\\\":[{\\\"bundleId\\\":\\\"test\\\",\\\"expiry\\\":\\\"2026-01-09T00:00:00.000Z\\\",\\\"hashedSub\\\":\\\"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0\\\",\\\"createdAt\\\":\\\"2026-01-08T00:14:09.670Z\\\",\\\"ttl\\\":1770595200,\\\"ttl_datestamp\\\":\\\"2026-02-09T00:00:00.000Z\\\"}]}\"}}"}
[test body] Found userInfo in localStorage for test "Click through: Submit a VAT return to HMRC": {"sub":"user","email":"user@example.com"}
[test body] Extracted userSub from localStorage for test "Click through: Submit a VAT return to HMRC": user
Logging out from home page
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.140Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.140Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.141Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.141Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
[USER INTERACTION] Clicking: a:has-text('Logout') - Logout
[BROWSER CONSOLE log]: Logging out user
[HTTP REQUEST FAILED] GET https://wanted-finally-anteater.ngrok-free.app/index.html - net::ERR_ABORTED
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.409Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.409Z\",\"msg\":\"HTTP GET /auth/login.html\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.469Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.469Z\",\"msg\":\"HTTP GET /submit.css\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.469Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.469Z\",\"msg\":\"HTTP GET /images/g-logo.png\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.475Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.475Z\",\"msg\":\"HTTP GET /widgets/view-source-link.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.490Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.490Z\",\"msg\":\"HTTP GET /lib/env-loader.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.491Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.491Z\",\"msg\":\"HTTP GET /submit.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.492Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.492Z\",\"msg\":\"HTTP GET /widgets/localstorage-viewer.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.493Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.493Z\",\"msg\":\"HTTP GET /widgets/auth-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.493Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.493Z\",\"msg\":\"HTTP GET /widgets/entitlement-status.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.494Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.494Z\",\"msg\":\"HTTP GET /widgets/hamburger-menu.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.495Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.495Z\",\"msg\":\"HTTP GET /lib/auth-url-builder.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.495Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.495Z\",\"msg\":\"HTTP GET /lib/request-cache.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.496Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.496Z\",\"msg\":\"HTTP GET /widgets/status-messages.js\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.497Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.497Z\",\"msg\":\"HTTP GET /lib/toml-parser.js\"}"}
[BROWSER CONSOLE log]: Current activity cleared
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.558Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.558Z\",\"msg\":\"HTTP GET /submit.env\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.562Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.562Z\",\"msg\":\"HTTP GET /submit.deployment-name.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.564Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.564Z\",\"msg\":\"HTTP GET /submit.catalogue.toml\"}"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.650Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.650Z","msg":"Sandbox mode detection: HMRC_ACCOUNT=sandbox => sandbox=true"}
[Figures]: Selected 5 key screenshots from target/behaviour-test-results/screenshots/submitVat-behaviour-test
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-08T00:14:49.655Z","msg":"Copied screenshot: 2026-01-08_00-14-15-557800665-10-fill-in-submission-pagedown.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-08T00:14:49.656Z","msg":"Copied screenshot: 2026-01-08_00-14-26-723638971-02-complete-vat-receipt.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-08T00:14:49.656Z","msg":"Copied screenshot: 2026-01-08_00-14-21-800409882-01-submit-hmrc-auth.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-08T00:14:49.657Z","msg":"Copied screenshot: 2026-01-08_00-14-39-849431741-04-view-vat-return-results.png"}
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-08T00:14:49.657Z","msg":"Copied screenshot: 2026-01-08_00-13-59-352225753-01-submit-mock.png"}
[Figures]: Copied 5 screenshots to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour
{"level":30,"source":"behaviour-tests/helpers/figures-helper.js","time":"2026-01-08T00:14:49.658Z","msg":"Wrote figures.json with 5 entries to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/figures.json"}
[Figures]: Generated figures.json in /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour
[DynamoDB Export]: Starting export of all tables...
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.658Z","msg":"[dynamodb-export]: Starting export of all tables to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.659Z","msg":"[dynamodb-export]: Exporting table 'test-bundle-table' from endpoint 'http://127.0.0.1:52137' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:49.667Z","msg":"[http-stdout]: {\"level\":30,\"source\":\"app/bin/server.js\",\"time\":\"2026-01-08T00:14:49.659Z\",\"msg\":\"HTTP GET /submit.version.txt\"}"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.669Z","msg":"[dynamodb-export]: ✅ Exported 1 items from table 'test-bundle-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.670Z","msg":"[dynamodb-export]: ── BEGIN bundles.jsonl ──"}
{"bundleId":"test","expiry":"2026-01-09T00:00:00.000Z","hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","createdAt":"2026-01-08T00:14:09.670Z","ttl":1770595200,"ttl_datestamp":"2026-02-09T00:00:00.000Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.670Z","msg":"[dynamodb-export]: ── END bundles.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.670Z","msg":"[dynamodb-export]: Exporting table 'test-hmrc-api-requests-table' from endpoint 'http://127.0.0.1:52137' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.676Z","msg":"[dynamodb-export]: ✅ Exported 5 items from table 'test-hmrc-api-requests-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.676Z","msg":"[dynamodb-export]: ── BEGIN hmrc-api-requests.jsonl ──"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-3b5dc59b-0085-42c4-a60d-08f148a0972e","requestId":"e974b8ad-d75c-4631-99e7-006babb12a55","amznTraceId":null,"traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","url":"https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate","method":"GET","httpRequest":{"method":"GET","headers":{"Accept":"application/vnd.hmrc.1.0+json","Authorization":"Bearer 3272583c6767455c5f4751d6f48b1076","Gov-Client-Public-IP":"88.97.27.180","Gov-Client-Device-ID":"b76e1602-11f2-49f5-8030-296a075931a3","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"88.97.27.180","Gov-Vendor-Forwarded":"by=88.97.27.180&for=88.97.27.180","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=0.0.2-4","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Public-IP-Timestamp":"2026-01-08T00:14:38.203Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+00:00","Gov-Client-Window-Size":"width=1280&height=1446","x-request-id":"e974b8ad-d75c-4631-99e7-006babb12a55","traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","x-correlationid":"e974b8ad-d75c-4631-99e7-006babb12a55"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"757","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 08 Jan 2026 00:14:38 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 4e8b36cb6949156d16691b29df3318d6.cloudfront.net (CloudFront)","x-amz-cf-id":"W8hRcMezJoRK3YExbpleG_0qfZ69-58cUsHCJ_LGEPZVbe3dmrxBRg==","x-amz-cf-pop":"LHR50-P6","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"31","x-frame-options":"SAMEORIGIN"},"body":{"specVersion":"3.3","code":"INVALID_HEADERS","message":"At least 1 header is invalid","errors":[{"code":"MISSING_HEADER","message":"Header missing. You will not be able to submit a header if the connection is between client and server in a private network. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-public-port"]}],"warnings":[{"code":"MISSING_HEADER","message":"Header missing. This may be correct for single factor authentication, for example username and password. If this is the case, you must contact us explaining why you cannot submit this header.","headers":["gov-client-multi-factor"]},{"code":"MISSING_HEADER","message":"Header required","headers":["gov-vendor-license-ids"]}]}},"duration":170,"createdAt":"2026-01-08T00:14:38.460Z","ttl":1770509678,"ttl_datestamp":"2026-02-08T00:14:38.460Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-3c87467c-c447-49e8-847c-d7c88df078a2","requestId":"f0cb8d51-c9f2-433d-8366-e84834ebd00e","amznTraceId":null,"traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"Bearer 3272583c6767455c5f4751d6f48b1076","x-request-id":"f0cb8d51-c9f2-433d-8366-e84834ebd00e","traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","x-correlationid":"f0cb8d51-c9f2-433d-8366-e84834ebd00e","Gov-Client-Public-IP":"88.97.27.180","Gov-Client-Device-ID":"1bd0fbd3-1fd7-43b0-ba03-8530dc5a3596","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"88.97.27.180","Gov-Vendor-Forwarded":"by=88.97.27.180&for=88.97.27.180","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=0.0.2-4","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Public-IP-Timestamp":"2026-01-08T00:14:46.062Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+00:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"227","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 08 Jan 2026 00:14:46 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 9ed2d1e9167be4746c63501b05bc4b68.cloudfront.net (CloudFront)","x-amz-cf-id":"k3eTj9-XskIDZzhJxNnejgt4yB0LfXIPqAJ-5LycZynAjDJPrJe8nQ==","x-amz-cf-pop":"LHR50-P6","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"559f927a-9c49-44f8-a321-d86d8e7bd31a","x-envoy-upstream-service-time":"15","x-frame-options":"SAMEORIGIN"},"body":{"obligations":[{"periodKey":"18A1","start":"2017-01-01","end":"2017-03-31","due":"2017-05-07","status":"F","received":"2017-05-06"},{"periodKey":"18A2","start":"2017-04-01","end":"2017-06-30","due":"2017-08-07","status":"O"}]}},"duration":145,"createdAt":"2026-01-08T00:14:46.299Z","ttl":1770509686,"ttl_datestamp":"2026-02-08T00:14:46.299Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-ac170d09-f920-41c5-ad76-c30692ce139d","requestId":"b91379b0-ea3b-4e49-828d-d13638a411ce","amznTraceId":null,"traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","url":"https://test-api.service.hmrc.gov.uk/oauth/token","method":"POST","httpRequest":{"method":"POST","headers":{"Content-Type":"application/x-www-form-urlencoded","x-request-id":"b91379b0-ea3b-4e49-828d-d13638a411ce","traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","x-correlationid":"b91379b0-ea3b-4e49-828d-d13638a411ce"},"body":"grant_type=authorization_code&client_id=uqMHA6RsDGGa7h8EG2VqfqAmv4tV&client_secret=049b662f-61ea-4113-b38d-a9c8b1bb9f13&redirect_uri=https%3A%2F%2Fwanted-finally-anteater.ngrok-free.app%2Factivities%2FsubmitVatCallback.html&code=15d929e02a51491ea9ac310457815a3c"},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"172","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 08 Jan 2026 00:14:24 GMT","strict-transport-security":"max-age=31536000;","via":"1.1 4e8b36cb6949156d16691b29df3318d6.cloudfront.net (CloudFront)","x-amz-cf-id":"-McYFopqxarrFe_pmH-UVV-yBThW-UIoTmQI1wghyRqO1qWGEv_PBQ==","x-amz-cf-pop":"LHR50-P6","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff","x-envoy-upstream-service-time":"54","x-frame-options":"SAMEORIGIN"},"body":{"access_token":"3272583c6767455c5f4751d6f48b1076","refresh_token":"4f1ff589d447319988116b71633c9ba1","expires_in":14400,"scope":"write:vat read:vat","token_type":"bearer"}},"duration":184,"createdAt":"2026-01-08T00:14:24.898Z","ttl":1770509664,"ttl_datestamp":"2026-02-08T00:14:24.898Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-bcf44e12-3dfa-4113-82e5-ff30034aff41","requestId":"e974b8ad-d75c-4631-99e7-006babb12a55","amznTraceId":null,"traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9","method":"GET","httpRequest":{"method":"GET","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"Bearer 3272583c6767455c5f4751d6f48b1076","x-request-id":"e974b8ad-d75c-4631-99e7-006babb12a55","traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","x-correlationid":"e974b8ad-d75c-4631-99e7-006babb12a55","Gov-Client-Public-IP":"88.97.27.180","Gov-Client-Device-ID":"b76e1602-11f2-49f5-8030-296a075931a3","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"88.97.27.180","Gov-Vendor-Forwarded":"by=88.97.27.180&for=88.97.27.180","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=0.0.2-4","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Public-IP-Timestamp":"2026-01-08T00:14:38.203Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+00:00","Gov-Client-Window-Size":"width=1280&height=1446"}},"httpResponse":{"statusCode":200,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"239","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 08 Jan 2026 00:14:38 GMT","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 4e8b36cb6949156d16691b29df3318d6.cloudfront.net (CloudFront)","x-amz-cf-id":"qO3G9bxj8mFn0qvkv0XKgSq4bBzi7p3ebQP7tP76zcA4Pgxscs64DA==","x-amz-cf-pop":"LHR50-P6","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"ff3c11fa-607b-405c-9877-ded420a59070","x-envoy-upstream-service-time":"18","x-frame-options":"SAMEORIGIN"},"body":{"periodKey":"25R9","vatDueSales":1000,"vatDueAcquisitions":0,"totalVatDue":1000,"vatReclaimedCurrPeriod":0,"netVatDue":1000,"totalValueSalesExVAT":0,"totalValuePurchasesExVAT":0,"totalValueGoodsSuppliedExVAT":0,"totalAcquisitionsExVAT":0}},"duration":112,"createdAt":"2026-01-08T00:14:38.577Z","ttl":1770509678,"ttl_datestamp":"2026-02-08T00:14:38.577Z"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","id":"hmrcreq-ffbd5861-aca1-4b84-b0fc-a829e4aec29f","requestId":"665b3d53-ac7e-4311-8bca-864bf233ea09","amznTraceId":null,"traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","url":"https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns","method":"POST","httpRequest":{"method":"POST","headers":{"Content-Type":"application/json","Accept":"application/vnd.hmrc.1.0+json","Authorization":"Bearer 3272583c6767455c5f4751d6f48b1076","x-request-id":"665b3d53-ac7e-4311-8bca-864bf233ea09","traceparent":"00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01","x-correlationid":"665b3d53-ac7e-4311-8bca-864bf233ea09","Gov-Client-Public-IP":"88.97.27.180","Gov-Client-Device-ID":"1d1a265a-ef23-478f-93c5-f49d808b9787","Gov-Client-User-IDs":"server=anonymous","Gov-Client-Connection-Method":"WEB_APP_VIA_SERVER","Gov-Vendor-Public-IP":"88.97.27.180","Gov-Vendor-Forwarded":"by=88.97.27.180&for=88.97.27.180","Gov-Vendor-Product-Name":"web-submit-diyaccounting-co-uk","Gov-Vendor-Version":"web-submit-diyaccounting-co-uk=0.0.2-4","Gov-Client-Browser-JS-User-Agent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/143.0.7499.4 Safari/537.36","Gov-Client-Public-IP-Timestamp":"2026-01-08T00:14:25.149Z","Gov-Client-Screens":"width=1280&height=1446&colour-depth=24&scaling-factor=1","Gov-Client-Timezone":"UTC+00:00","Gov-Client-Window-Size":"width=1280&height=1446"},"body":"{\"periodKey\":\"25R9\",\"vatDueSales\":1000,\"vatDueAcquisitions\":0,\"totalVatDue\":1000,\"vatReclaimedCurrPeriod\":0,\"netVatDue\":1000,\"totalValueSalesExVAT\":0,\"totalValuePurchasesExVAT\":0,\"totalValueGoodsSuppliedExVAT\":0,\"totalAcquisitionsExVAT\":0,\"finalised\":true}"},"httpResponse":{"statusCode":201,"headers":{"cache-control":"no-cache,no-store,max-age=0","connection":"keep-alive","content-length":"140","content-security-policy":"default-src 'self'","content-type":"application/json","date":"Thu, 08 Jan 2026 00:14:25 GMT","receipt-id":"4ad4c7d4-23f2-4159-b12a-c1e2e4c3606c","receipt-signature":"This has been deprecated - DO NOT USE","receipt-timestamp":"2026-01-08T00:14:25Z","strict-transport-security":"max-age=31536000;","vary":"Origin","via":"1.1 4e8b36cb6949156d16691b29df3318d6.cloudfront.net (CloudFront)","x-amz-cf-id":"uiGowaIbKW7_sK2BKoELpHJ5_HksadY4byvqCQxaj5yjTSEJkI8Obw==","x-amz-cf-pop":"LHR50-P6","x-cache":"Miss from cloudfront","x-content-type-options":"nosniff, nosniff","x-correlationid":"4ad4c7d4-23f2-4159-b12a-c1e2e4c3606c","x-envoy-upstream-service-time":"33","x-frame-options":"SAMEORIGIN"},"body":{"processingDate":"2026-01-08T00:14:25.361Z","formBundleNumber":"182326150164","paymentIndicator":"DD","chargeRefNumber":"GFpuOum4aEfNo26B"}},"duration":184,"createdAt":"2026-01-08T00:14:25.371Z","ttl":1770509665,"ttl_datestamp":"2026-02-08T00:14:25.371Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.676Z","msg":"[dynamodb-export]: ── END hmrc-api-requests.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.676Z","msg":"[dynamodb-export]: Exporting table 'test-receipts-table' from endpoint 'http://127.0.0.1:52137' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.680Z","msg":"[dynamodb-export]: ✅ Exported 1 items from table 'test-receipts-table' to '/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.680Z","msg":"[dynamodb-export]: ── BEGIN receipts.jsonl ──"}
{"hashedSub":"5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0","receiptId":"2026-01-08T00:14:25.375Z-182326150164","receipt":{"processingDate":"2026-01-08T00:14:25.361Z","formBundleNumber":"182326150164","paymentIndicator":"DD","chargeRefNumber":"GFpuOum4aEfNo26B"},"createdAt":"2026-01-08T00:14:25.376Z","ttl":1988583265,"ttl_datestamp":"2033-01-06T00:14:25.376Z"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.680Z","msg":"[dynamodb-export]: ── END receipts.jsonl ──"}
{"level":30,"source":"behaviour-tests/helpers/dynamodb-export.js","time":"2026-01-08T00:14:49.680Z","msg":"[dynamodb-export]: ✅ Completed export of all tables"}
[DynamoDB Export]: Export completed: [
  {
    table: [32m'bundles'[39m,
    itemCount: [33m1[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/bundles.jsonl'[39m
  },
  {
    table: [32m'hmrc-api-requests'[39m,
    itemCount: [33m5[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl'[39m
  },
  {
    table: [32m'receipts'[39m,
    itemCount: [33m1[39m,
    filePath: [32m'/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/receipts.jsonl'[39m
  }
]
Asserting HMRC API request exists: POST /oauth/token
[DynamoDB Assertions]: Found 1 OAuth token exchange request(s)
Asserting HMRC API request exists: POST /organisations/vat/948796348/returns
[DynamoDB Assertions]: Found 1 VAT return POST request(s)
Matched all expected values in https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns: { [32m'httpRequest.method'[39m: [32m'POST'[39m, [32m'httpResponse.statusCode'[39m: [33m201[39m }
[DynamoDB Assertions]: VAT POST request body validated successfully
Asserting HMRC API request exists: GET /organisations/vat/948796348/returns/25R9
[DynamoDB Assertions]: Found 1 VAT return GET request(s)
Matched all expected values in https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9: { [32m'httpRequest.method'[39m: [32m'GET'[39m, [32m'httpResponse.statusCode'[39m: [33m200[39m }
[DynamoDB Assertions]: VAT GET response body validated successfully
[DynamoDB Assertions]: Found 0 Fraud prevention headers validation feedback GET request(s)
Asserting HMRC API request exists: GET /test/fraud-prevention-headers/validate
[DynamoDB Assertions]: Found 1 Fraud prevention headers validation GET request(s)
[DynamoDB Assertions]: Fraud prevention headers validation GET request #1 validated successfully with details:
[DynamoDB Assertions]: Request code: INVALID_HEADERS
[DynamoDB Assertions]: Errors: 1
[DynamoDB Assertions]: Warnings: 2
[DynamoDB Assertions]: Ignored headers: gov-client-multi-factor,gov-vendor-license-ids,gov-client-public-port
[DynamoDB Assertions]: Errors: 0 (out of non-ignored 1 headers)
[DynamoDB Assertions]: Warnings: 0 (out of non-ignored 2 headers)
[DynamoDB Assertions]: Request code: INVALID_HEADERS
[DynamoDB Assertions]: Fraud prevention headers validation GET body validated successfully
{"level":30,"source":"behaviour-tests/helpers/dynamodb-assertions.js","time":"2026-01-08T00:14:49.697Z","msg":"Found 5 HMRC API requests: OAuth (1) with hashedSub 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0, authenticated (4) with hashedSub 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0"}
[DynamoDB Assertions]: Found 1 unique hashedSub value(s): 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0
[afterEach] Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/userSub.txt for test "Click through: Submit a VAT return to HMRC": user
{"level":30,"source":"app/services/subHasher.js","time":"2026-01-08T00:14:49.796Z","message":"Using USER_SUB_HASH_SALT from environment (local dev/test)"}
[fileHelper] Salt initialized successfully for test diagnostics
[afterEach] Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hashedUserSub.txt for test "Click through: Submit a VAT return to HMRC": 5f202fdb051350c5da3294b66ca72ea2fe0b92e841a7b04d378300a848a3dfb0
Saving /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/traceparent.txt for test "Click through: Submit a VAT return to HMRC": 00-632bc3d0ce73772becc2a8a6a4bda9d6-8713f015f357a91b-01
{"level":30,"source":"behaviour-tests/helpers/behaviour-helpers.js","time":"2026-01-08T00:14:51.288Z","msg":"[proxy]: kill() called on ngrok proxy, stopping..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-08T00:14:51.289Z","msg":"[ngrok]: Closing tunnel..."}
{"level":30,"source":"app/bin/ngrok.js","time":"2026-01-08T00:14:51.337Z","msg":"[ngrok]: ✅ Tunnel closed"}
  ✓  1 [submitVatBehaviour] › behaviour-tests/submitVat.behaviour.test.js:203:1 › Click through: Submit a VAT return to HMRC (56.3s)

  1 passed (1.0m)

To open last HTML report run:
[36m[39m
[36m  npx playwright show-report target/test-reports/html-report[39m
[36m[39m

> web-submit-diyaccounting-co-uk@0.0.2-4 test-report
> node scripts/generate-test-reports.js --testName html-report --testName submitVatBehaviour --testFile ./behaviour-tests/submitVat.behaviour.test.js --envFile .env.proxy

=== Generating Test Reports ===
Project root: /Users/antony/projects/submit.diyaccounting.co.uk
Results directory: /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results
Reports directory: /Users/antony/projects/submit.diyaccounting.co.uk/target/test-reports/html-report
Output directory: /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results
Node v22.17.0 | cwd=/Users/antony/projects/submit.diyaccounting.co.uk

Direct mode: generating report for test 'submitVatBehaviour'
Reading test file behaviour-tests/submitVat.behaviour.test.js (23KB)
Reading env file .env.proxy (2.3KB)
Searching fallback data in /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results
Explore dir for testContext.json: /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results
Found testContext.json at /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/testContext.json
Explore dir for hmrc-api-requests.jsonl: /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results
Found hmrc-api-requests.jsonl at /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl
findTestData result (fallback): testContext=true, api=true
Generating report for: submitVatBehaviour
Read testContext from /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/testContext.json (1.9KB)
testContext keys: testId, name, title, description, hmrcApis, env, testData, artefactsDir, screenshotPath, testStartTime
Reading HMRC API requests from: /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl
Open JSONL file (13KB): /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/hmrc-api-requests.jsonl
HMRC API request GET https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate
undefined
undefined
HMRC API request GET https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01
undefined
undefined
HMRC API request POST https://test-api.service.hmrc.gov.uk/oauth/token
undefined
undefined
HMRC API request GET https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9
undefined
undefined
HMRC API request POST https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns
undefined
undefined
Parsed 5 JSONL entries (0 failed)
Read 5 HMRC API requests
API request URL preview: https://test-api.service.hmrc.gov.uk/test/fraud-prevention-headers/validate, https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/obligations?from=2025-01-01&to=2025-12-01, https://test-api.service.hmrc.gov.uk/oauth/token, https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns/25R9, https://test-api.service.hmrc.gov.uk/organisations/vat/948796348/returns
Playwright HTML report exists: /Users/antony/projects/submit.diyaccounting.co.uk/target/test-reports/html-report/index.html
Reading last-run metadata from /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/.last-run.json
Derived test status from .last-run.json: passed
Test outcome: passed
Read test source file: behaviour-tests/submitVat.behaviour.test.js
Read environment config: .env.proxy
Explore dir for figures.json: /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results
Found figures.json at /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/figures.json
Read figures.json (/Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVat.behaviour-Click--3e6d3-Submit-a-VAT-return-to-HMRC-submitVatBehaviour/figures.json) with 5 curated screenshots
Screenshot preview: 2026-01-08_00-14-15-557800665-10-fill-in-submission-pagedown.png, 2026-01-08_00-14-26-723638971-02-complete-vat-receipt.png, 2026-01-08_00-14-21-800409882-01-submit-hmrc-auth.png, 2026-01-08_00-14-39-849431741-04-view-vat-return-results.png, 2026-01-08_00-13-59-352225753-01-submit-mock.png
Copied figures.json to /Users/antony/projects/submit.diyaccounting.co.uk/target/behaviour-test-results/submitVatBehaviour-figures.json
Found video: video.webm
Found 5 screenshot(s)
Found 1 video(s)
Generated test-report-submitVatBehaviour.json (47KB)

=== Test Report Generation Complete ===
target/behaviour-test-results/test-report-submitVatBehaviour.json -> web/public/tests/test-report-web-test-local.json
2026-01-08_00-14-15-557800665-10-fill-in-submission-pagedown.png
2026-01-08_00-14-26-723638971-02-complete-vat-receipt.png
2026-01-08_00-14-21-800409882-01-submit-hmrc-auth.png
2026-01-08_00-14-39-849431741-04-view-vat-return-results.png
2026-01-08_00-13-59-352225753-01-submit-mock.png
Cleaned from 2026-01-08_00-14-15-557800665-10-fill-in-submission-pagedown.png to fill-in-submission-pagedown.png
target/behaviour-test-results/screenshots/submitVat-behaviour-test/2026-01-08_00-14-15-557800665-10-fill-in-submission-pagedown.png -> web/public/tests/behaviour-test-results/web-test-local/fill-in-submission-pagedown.png
Cleaned from 2026-01-08_00-14-26-723638971-02-complete-vat-receipt.png to complete-vat-receipt.png
target/behaviour-test-results/screenshots/submitVat-behaviour-test/2026-01-08_00-14-26-723638971-02-complete-vat-receipt.png -> web/public/tests/behaviour-test-results/web-test-local/complete-vat-receipt.png
Cleaned from 2026-01-08_00-14-21-800409882-01-submit-hmrc-auth.png to submit-hmrc-auth.png
target/behaviour-test-results/screenshots/submitVat-behaviour-test/2026-01-08_00-14-21-800409882-01-submit-hmrc-auth.png -> web/public/tests/behaviour-test-results/web-test-local/submit-hmrc-auth.png
Cleaned from 2026-01-08_00-14-39-849431741-04-view-vat-return-results.png to view-vat-return-results.png
target/behaviour-test-results/screenshots/submitVat-behaviour-test/2026-01-08_00-14-39-849431741-04-view-vat-return-results.png -> web/public/tests/behaviour-test-results/web-test-local/view-vat-return-results.png
Cleaned from 2026-01-08_00-13-59-352225753-01-submit-mock.png to submit-mock.png
target/behaviour-test-results/screenshots/submitVat-behaviour-test/2026-01-08_00-13-59-352225753-01-submit-mock.png -> web/public/tests/behaviour-test-results/web-test-local/submit-mock.png
target/test-reports/html-report -> web/public/tests/test-reports/web-test-local/html-report
target/test-reports/html-report/index.html -> web/public/tests/test-reports/web-test-local/html-report/index.html
target/test-reports/html-report/trace -> web/public/tests/test-reports/web-test-local/html-report/trace
target/test-reports/html-report/trace/index.html -> web/public/tests/test-reports/web-test-local/html-report/trace/index.html
target/test-reports/html-report/trace/uiMode.Btcz36p_.css -> web/public/tests/test-reports/web-test-local/html-report/trace/uiMode.Btcz36p_.css
target/test-reports/html-report/trace/xtermModule.DYP7pi_n.css -> web/public/tests/test-reports/web-test-local/html-report/trace/xtermModule.DYP7pi_n.css
target/test-reports/html-report/trace/defaultSettingsView.ConWv5KN.css -> web/public/tests/test-reports/web-test-local/html-report/trace/defaultSettingsView.ConWv5KN.css
target/test-reports/html-report/trace/codeMirrorModule.C3UTv-Ge.css -> web/public/tests/test-reports/web-test-local/html-report/trace/codeMirrorModule.C3UTv-Ge.css
target/test-reports/html-report/trace/uiMode.BWTwXl41.js -> web/public/tests/test-reports/web-test-local/html-report/trace/uiMode.BWTwXl41.js
target/test-reports/html-report/trace/codicon.DCmgc-ay.ttf -> web/public/tests/test-reports/web-test-local/html-report/trace/codicon.DCmgc-ay.ttf
target/test-reports/html-report/trace/snapshot.html -> web/public/tests/test-reports/web-test-local/html-report/trace/snapshot.html
target/test-reports/html-report/trace/index.C4Y3Aw8n.css -> web/public/tests/test-reports/web-test-local/html-report/trace/index.C4Y3Aw8n.css
target/test-reports/html-report/trace/index.BxQ34UMZ.js -> web/public/tests/test-reports/web-test-local/html-report/trace/index.BxQ34UMZ.js
target/test-reports/html-report/trace/manifest.webmanifest -> web/public/tests/test-reports/web-test-local/html-report/trace/manifest.webmanifest
target/test-reports/html-report/trace/sw.bundle.js -> web/public/tests/test-reports/web-test-local/html-report/trace/sw.bundle.js
target/test-reports/html-report/trace/uiMode.html -> web/public/tests/test-reports/web-test-local/html-report/trace/uiMode.html
target/test-reports/html-report/trace/assets -> web/public/tests/test-reports/web-test-local/html-report/trace/assets
target/test-reports/html-report/trace/assets/codeMirrorModule-Bucv2d7q.js -> web/public/tests/test-reports/web-test-local/html-report/trace/assets/codeMirrorModule-Bucv2d7q.js
target/test-reports/html-report/trace/assets/defaultSettingsView-BEpdCv1S.js -> web/public/tests/test-reports/web-test-local/html-report/trace/assets/defaultSettingsView-BEpdCv1S.js
target/test-reports/html-report/trace/playwright-logo.svg -> web/public/tests/test-reports/web-test-local/html-report/trace/playwright-logo.svg
target/test-reports/html-report/data -> web/public/tests/test-reports/web-test-local/html-report/data
target/test-reports/html-report/data/fdcb4e2cce6a5980c0ffaed4a5cd9b1e1bccc3c0.png -> web/public/tests/test-reports/web-test-local/html-report/data/fdcb4e2cce6a5980c0ffaed4a5cd9b1e1bccc3c0.png
target/test-reports/html-report/data/c6c722138a49650518a91d92720a93390cfb8635.zip -> web/public/tests/test-reports/web-test-local/html-report/data/c6c722138a49650518a91d92720a93390cfb8635.zip
target/test-reports/html-report/data/15f980e1fb9b9c42fca30fcb46121df1cabdab22.png -> web/public/tests/test-reports/web-test-local/html-report/data/15f980e1fb9b9c42fca30fcb46121df1cabdab22.png
